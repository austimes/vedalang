# VEDA Tag and Field Constraints
# Defines valid combinations of tags, files, and required fields.
# Used for validation and guidance during model construction.

tag_constraints:
  # ============================================================================
  # FI (File Import) Tags - Define model structure
  # ============================================================================
  
  "~FI_COMM":
    description: Define commodities
    valid_files:
      - "SysSettings/*.xlsx"
      - "BY_Trans/*.xlsx"
    required_fields:
      - Csets
      - CommName
    optional_fields:
      - Unit
      - CTSLvl
      - PeakTS
      - Desc
    example_row:
      Csets: NRG
      CommName: ELC
      Unit: PJ
  
  "~FI_PROCESS":
    description: Define processes/technologies
    valid_files:
      - "SubRES_*/*.xlsx"
      - "BY_Trans/*.xlsx"
    required_fields:
      - TechName
      - Sets
    optional_fields:
      - TechDesc
      - Tact
      - Tcap
      - Vintage
    example_row:
      TechName: PP_CCGT
      Sets: ELE
      Tact: PJ
      Tcap: GW
  
  "~FI_T":
    description: Define process topology (inputs, outputs, efficiency) or commodity attributes
    valid_files:
      - "SubRES_*/*.xlsx"
      - "BY_Trans/*.xlsx"
    # Note: TechName is required for process rows, but commodity-level attributes
    # (like DEMAND for COM_PROJ) use commodity column instead. We use any_of_fields
    # to allow both patterns.
    any_of_fields:
      - fields: ["TechName", "Attribute"]
        description: Must have TechName (process rows) or Attribute (commodity rows like DEMAND)
      - fields: ["Comm-IN", "Comm-OUT", "EFF", "Value"]
        description: Must have at least one of input, output, efficiency, or value
    optional_fields:
      - Share-I
      - Share-O
      - FLO_SHAR
      - Commodity
      - Year
    example_row:
      TechName: PP_CCGT
      Comm-IN: NG
      Comm-OUT: ELC
      EFF: 0.55

  # ============================================================================
  # TFM (Transformation) Tags - Modify/extend model
  # ============================================================================
  
  "~TFM_INS":
    description: Insert/update data for existing processes or system parameters
    valid_files:
      - "Scen_*/*.xlsx"
      - "SysSettings/*.xlsx"
    required_fields:
      - Attribute
    # Note: TechName is NOT required - system-level parameters (like YRFR, Discount)
    # don't have TechName. Use any_of_fields if we want to validate process-specific rows.
    optional_fields:
      - TechName
      - TimeSlice
      - AllRegions
    note: Used for scenario-specific parameter changes and system parameters (YRFR, Discount, etc.)

  "~TFM_INS-TS":
    description: Insert time-series data
    valid_files:
      - "Scen_*/*.xlsx"
    required_fields:
      - YEAR
    note: Used for time-varying parameters like prices, demands

# Field type definitions
field_types:
  TechName:
    type: string
    max_length: 32
    pattern: "^[A-Z][A-Z0-9_]*$"
    description: Technology/process identifier
  
  CommName:
    type: string
    max_length: 32
    description: Commodity identifier
  
  Sets:
    type: string
    description: Comma-separated set memberships (e.g., "ELE,RNEW")
  
  EFF:
    type: number
    min: 0
    max: 1
    description: Process efficiency
  
  YEAR:
    type: integer
    min: 1990
    max: 2100
    description: Model year

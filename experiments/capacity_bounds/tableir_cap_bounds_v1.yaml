# TableIR experiment: Capacity bounds (CAP_BND, NCAP_BND)
# Testing patterns that may not be covered by vedalang-014
#
# KEY QUESTIONS:
# 1. Do CAP_BND and NCAP_BND use the same limtype column as ACT_BND?
# 2. Can we specify time-varying bounds (year-specific limits)?
# 3. Can we have both CAP_BND and NCAP_BND on same process?

files:
  - path: SysSettings/SysSettings.xlsx
    sheets:
      - name: SysSets
        tables:
          - tag: ~BOOKREGIONS_MAP
            rows:
              - bookname: REG1
                region: REG1
          - tag: ~STARTYEAR
            rows:
              - value: 2020
          - tag: ~ACTIVEPDEF
            rows:
              - value: P
          - tag: ~TIMEPERIODS
            rows:
              - p: 10
              - p: 10
              - p: 10
          - tag: ~CURRENCIES
            rows:
              - currency: USD
      - name: Commodities
        tables:
          - tag: ~FI_COMM
            rows:
              - region: REG1
                csets: NRG
                commname: NG
                unit: PJ
              - region: REG1
                csets: NRG
                commname: ELC
                unit: PJ
              - region: REG1
                csets: DEM
                commname: RSD
                unit: PJ

  - path: SubRES_TMPL/SubRES_Model.xlsx
    sheets:
      - name: Processes
        tables:
          - tag: ~FI_PROCESS
            rows:
              - region: REG1
                techname: PP_CCGT
                techdesc: "CCGT power plant with capacity limits"
                sets: ELE
                tact: PJ
                tcap: GW
              - region: REG1
                techname: PP_WIND
                techdesc: "Wind power with new capacity limit"
                sets: ELE
                tact: PJ
                tcap: GW
              - region: REG1
                techname: DMD_RSD
                techdesc: "Residential demand device"
                sets: DMD
                tact: PJ
                tcap: PJ
          
          - tag: ~FI_T
            rows:
              # CCGT topology
              - region: REG1
                techname: PP_CCGT
                commodity-in: NG
              - region: REG1
                techname: PP_CCGT
                commodity-out: ELC
              - region: REG1
                techname: PP_CCGT
                eff: 0.55
              
              # PATTERN 1: Total capacity upper bound (CAP_BND)
              # Max 10 GW total installed capacity
              - region: REG1
                techname: PP_CCGT
                limtype: UP
                cap_bnd: 10.0
              
              # Wind topology
              - region: REG1
                techname: PP_WIND
                commodity-out: ELC
              
              # PATTERN 2: New capacity upper bound (NCAP_BND)
              # Max 2 GW new build per period
              - region: REG1
                techname: PP_WIND
                limtype: UP
                ncap_bnd: 2.0
              
              # Demand device
              - region: REG1
                techname: DMD_RSD
                commodity-in: ELC
              - region: REG1
                techname: DMD_RSD
                commodity-out: RSD

# TableIR Experiment: Mini plant model WITH timeslice definitions
#
# This extends the mini_plant example to include timeslices.
# Goal: Eliminate the MISSING_TIMESLICES warning.
#
# Timeslice structure:
#   - 4 timeslices: SD, SN, WD, WN (Season Ã— DayNite)
#   - Year fractions that sum to 1.0

files:
  - path: SysSettings/SysSettings.xlsx
    sheets:
      - name: "sys-settings"
        tables:
          # Region mapping
          # BookName must match VT_{BookName}_* file pattern
          - tag: "~BOOKREGIONS_MAP"
            rows:
              - bookname: REG1
                region: REG1

          # Timeslice definition - 4 timeslices
          # xl2times looks for columns: season, weekly, daynite
          - tag: "~TIMESLICES"
            rows:
              - season: S
                weekly: ""
                daynite: D
              - season: W
                weekly: ""
                daynite: N

          # Start year
          - tag: "~STARTYEAR"
            rows:
              - value: 2020

          # Active period definition
          - tag: "~ACTIVEPDEF"
            rows:
              - value: P

          # Time periods
          - tag: "~TIMEPERIODS"
            rows:
              - p: 10
              - p: 10
              - p: 10

          # Currencies
          - tag: "~CURRENCIES"
            rows:
              - currency: USD

      - name: "commodities"
        tables:
          - tag: "~FI_COMM"
            rows:
              - region: REG1
                csets: NRG
                commname: ELC
                unit: PJ
              - region: REG1
                csets: NRG
                commname: NG
                unit: PJ

      - name: "constants"
        tables:
          # Year fractions for each timeslice
          # MUST sum to 1.0 (or close to it)
          - tag: "~TFM_INS"
            rows:
              - timeslice: SD
                attribute: YRFR
                allregions: 0.25
              - timeslice: SN
                attribute: YRFR
                allregions: 0.23
              - timeslice: WD
                attribute: YRFR
                allregions: 0.25
              - timeslice: WN
                attribute: YRFR
                allregions: 0.27

  # Use VT_REG1_ prefix so xl2times treats REG1 as internal region
  - path: VT_REG1_ELC.xlsx
    sheets:
      - name: "processes"
        tables:
          - tag: "~FI_PROCESS"
            rows:
              - region: REG1
                techname: PP_CCGT
                techdesc: Combined Cycle Gas Turbine
                sets: ELE
                tact: PJ
                tcap: GW

          - tag: "~FI_T"
            rows:
              - region: REG1
                techname: PP_CCGT
                commodity-in: NG
              - region: REG1
                techname: PP_CCGT
                commodity-out: ELC
              - region: REG1
                techname: PP_CCGT
                eff: 0.55

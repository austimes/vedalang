# TableIR Experiment: 4-timeslice definition (Seasonal + DayNite)
#
# Creates timeslices: SD, SN, WD, WN
# Uses lowercase column names (TableIR canonical form)

files:
  - path: SysSettings/SysSettings.xlsx
    sheets:
      - name: "sys-settings"
        tables:
          # Region mapping
          - tag: "~BOOKREGIONS_MAP"
            rows:
              - bookname: REG
                region: REG1

          # Timeslice definition using column-based hierarchy
          # xl2times looks for columns: season, weekly, daynite (case-insensitive)
          # Extracts unique values per column, then creates cross-product
          - tag: "~TIMESLICES"
            rows:
              - season: S
                weekly: ""
                daynite: D
              - season: W
                weekly: ""
                daynite: N

          # Start year
          - tag: "~STARTYEAR"
            rows:
              - value: 2020

          # Active period definition
          - tag: "~ACTIVEPDEF"
            rows:
              - value: P

          # Time periods
          - tag: "~TIMEPERIODS"
            rows:
              - p: 10
              - p: 10
              - p: 10

          # Currencies
          - tag: "~CURRENCIES"
            rows:
              - currency: USD

      - name: "constants"
        tables:
          # Year fractions - MUST sum to 1.0
          # YRFR maps to G_YRFR parameter in TIMES
          - tag: "~TFM_INS"
            rows:
              - timeslice: SD
                attribute: YRFR
                allregions: 0.25
              - timeslice: SN
                attribute: YRFR
                allregions: 0.23
              - timeslice: WD
                attribute: YRFR
                allregions: 0.25
              - timeslice: WN
                attribute: YRFR
                allregions: 0.27

# TableIR Experiment: 4-timeslice definition (Seasonal + DayNite)
#
# Creates timeslices: SD (Summer-Day), SN (Summer-Night), WD (Winter-Day), WN (Winter-Night)
# Mirrors DemoS_010/SysSettings.xlsx pattern
#
# Key insight: The ~TIMESLICES table uses column-based hierarchy:
#   - Column headers are the LEVEL names (Season, Weekly, DayNite)
#   - Cell values are the timeslice SHORT CODES
#   - xl2times creates cross-product and concatenates names

files:
  - path: SysSettings/SysSettings.xlsx
    sheets:
      - name: "Region-Time Slices"
        tables:
          # Region mapping
          - tag: "~BookRegions_Map"
            rows:
              - BookName: REG
                Region: REG1

          # Timeslice definition using column-based hierarchy
          # Each row provides one value per level
          # xl2times creates cartesian product: S×D, S×N, W×D, W×N → SD, SN, WD, WN
          - tag: "~TIMESLICES"
            rows:
              # Note: This is NOT how the raw table looks in Excel
              # The actual VEDA format uses Season, Weekly, DayNite columns
              # Emitter needs to reconstruct this format
              - Season: S
                Weekly: ""
                DayNite: D
              - Season: W
                Weekly: ""
                DayNite: N

      - name: TimePeriods
        tables:
          - tag: "~STARTYEAR"
            rows:
              - VALUE: 2020

      - name: Defaults
        tables:
          - tag: "~CURRENCIES"
            rows:
              - Currency: MEUR

      - name: Constants
        tables:
          # Year fractions for each timeslice
          # MUST sum to 1.0 (or close to it)
          # These are specified via ~TFM_INS with YRFR attribute
          - tag: "~TFM_INS"
            rows:
              # Summer Day: 175 days × 12.5 hours / 8760 hours = 0.25
              - TimeSlice: SD
                Attribute: YRFR
                AllRegions: 0.25
              # Summer Night: 175 days × 11.5 hours / 8760 hours = 0.23
              - TimeSlice: SN
                Attribute: YRFR
                AllRegions: 0.23
              # Winter Day: 190 days × 11.5 hours / 8760 hours = 0.25
              - TimeSlice: WD
                Attribute: YRFR
                AllRegions: 0.25
              # Winter Night: 190 days × 12.5 hours / 8760 hours = 0.27
              - TimeSlice: WN
                Attribute: YRFR
                AllRegions: 0.27

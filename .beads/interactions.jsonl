{"id":"vedalang-014","title":"Add capacity and activity bounds to processes","description":"Schema extension P-bounds-001: Add bound parameters to process schema.\n\nChanges needed:\n1. Add to process schema: activity_bound_up, cap_bound_up, ncap_bound_up (numbers)\n2. Emit as limtype + act_bnd/cap_bnd columns in ~FI_T\n\nExample:\n```yaml\nprocesses:\n  - name: IMP_NG\n    sets: [IMP]\n    outputs:\n      - commodity: NG\n    cost: 5.0\n    activity_bound_up: 100  # Max 100 PJ/yr\n```\n\nLower priority than costs. See: experiments/handoff/session_2025-12-22_fuel_supply.yaml","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T11:03:12.593707+11:00","updated_at":"2025-12-22T13:02:28.538039+11:00","closed_at":"2025-12-22T13:02:28.538039+11:00","close_reason":"Implemented. Added activity_bound, cap_bound, ncap_bound with up/lo/fx keys. Compiler emits to ~FI_T with limtype column. 3 tests added. See vedalang/examples/example_with_bounds.veda.yaml","dependencies":[{"issue_id":"vedalang-014","depends_on_id":"vedalang-2cr","type":"discovered-from","created_at":"2025-12-22T11:03:12.595085+11:00","created_by":"gre538"}],"comments":[{"id":1,"issue_id":"vedalang-014","author":"gre538","text":"Expanded scope from vedalang-381 exploration:\n\nValidated ALL limtypes (UP/LO/FX) and time-varying bounds.\nExperiments in experiments/capacity_bounds/ (v2-v5 all pass veda_check).\n\nSchema proposal needs:\n- activity_bound, cap_bound, ncap_bound as objects with up/lo/fx keys\n- Time-varying support using time_series pattern\n\nFull details: experiments/handoff/session_2025-12-22_capacity_bounds.yaml","created_at":"2025-12-22T00:09:20Z"}]}
{"id":"vedalang-02l","title":"Seed rules/ with initial pattern library","description":"Create the initial pattern library for mapping modeling concepts to VedaLang/TableIR.\n\n## Location:\n`rules/`\n\n## Files to create:\n\n### 1. `rules/patterns.yaml`\nDefine reusable patterns for common modeling constructs:\n```yaml\npatterns:\n  add_power_plant:\n    description: Define a thermal generation process\n    parameters:\n      - name: plant_name\n      - name: fuel_commodity\n      - name: output_commodity\n      - name: efficiency\n        default: 0.40\n      - name: capacity_unit\n        default: GW\n    vedalang_template: |\n      processes:\n        - name: {{ plant_name }}\n          sets: [ELE]\n          inputs:\n            - commodity: {{ fuel_commodity }}\n          outputs:\n            - commodity: {{ output_commodity }}\n          efficiency: {{ efficiency }}\n          capacity_unit: {{ capacity_unit }}\n  \n  co2_price_trajectory:\n    description: Define a CO2 price scenario\n    parameters:\n      - name: prices  # dict of year -\u003e price\n    tableir_template: |\n      tag: ~TFM_INS-TS\n      rows:\n        {% for year, price in prices.items() %}\n        - YEAR: {{ year }}\n          COM: CO2\n          VALUE: {{ price }}\n        {% endfor %}\n```\n\n### 2. `rules/constraints.yaml`\nDefine valid combinations of tags/files:\n```yaml\nconstraints:\n  tag_file_mapping:\n    ~FI_COMM: [SysSettings/*.xlsx, BY_Trans/*.xlsx]\n    ~FI_PROCESS: [SubRES_*/*.xlsx, BY_Trans/*.xlsx]\n    ~FI_T: [SubRES_*/*.xlsx, BY_Trans/*.xlsx]\n  \n  required_fields:\n    ~FI_PROCESS: [PRC, Sets]\n    ~FI_T: [PRC, COM_IN | COM_OUT]\n```\n\n### 3. `rules/decision_tree.yaml`\nRoute modeling intent to appropriate patterns:\n```yaml\nintents:\n  add_generation:\n    keywords: [power plant, generator, thermal]\n    pattern: add_power_plant\n  \n  add_emissions_price:\n    keywords: [CO2 price, carbon tax, emissions]\n    pattern: co2_price_trajectory\n```\n\n## Acceptance:\n- All three YAML files exist with initial content\n- Structure is documented (comments or README)\n- At least one pattern (add_power_plant) is fully defined","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T16:44:22.743074+11:00","updated_at":"2025-12-21T17:35:22.890536+11:00","closed_at":"2025-12-21T17:35:22.890536+11:00","close_reason":"Closed","labels":["patterns","phase-5","rules"],"dependencies":[{"issue_id":"vedalang-02l","depends_on_id":"vedalang-e0g","type":"blocks","created_at":"2025-12-21T16:44:22.744336+11:00","created_by":"gre538"}]}
{"id":"vedalang-0rg","title":"Add golden fixture regression tests","description":"Create regression test suite that validates all golden fixtures pass through the full pipeline.","acceptance_criteria":"- [ ] `tests/test_golden_fixtures.py` runs veda_check on all examples\n- [ ] Test fails if any fixture breaks\n- [ ] Test captures TableIR snapshots for comparison\n- [ ] CI runs this on every change","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.721053+11:00","updated_at":"2025-12-21T20:08:38.430318+11:00","closed_at":"2025-12-21T20:08:38.430318+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-0rg","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:34.954422+11:00","created_by":"gre538"}]}
{"id":"vedalang-19e","title":"DC4: Add CO2 price trajectory scenario","description":"Design challenge 4: Apply CO2 price over 2025-2030. First scenario/TFM construct.","acceptance_criteria":"- [ ] `co2_price_trajectory` pattern produces valid `~TFM_INS-TS` TableIR\n- [ ] VedaLang schema extended to support scenarios (minimal structure)\n- [ ] Compiler maps scenario → TableIR correctly\n- [ ] xl2times accepts the scenario tables\n- [ ] Create golden fixture `vedalang/examples/dc4_co2_price_scenario.veda.yaml`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:57:35.720366+11:00","updated_at":"2025-12-21T20:31:52.233649+11:00","closed_at":"2025-12-21T20:31:52.233649+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-19e","depends_on_id":"vedalang-a9w","type":"blocks","created_at":"2025-12-21T17:59:18.988213+11:00","created_by":"gre538"}]}
{"id":"vedalang-1ak","title":"Explore Storage","description":"## Primitive: Storage\n**Parent:** vedalang-fq8\n\n## Intent\nTechnologies that store energy and shift it between time periods with round-trip efficiency.\n\n## Experiment Plan\n1. **Approximate (no timeslices):** Same commodity input/output with efficiency \u003c 1\n2. **Advanced:** Try explicit temporal behavior\n\n## Key Questions\n- Can storage be meaningfully represented without timeslices?\n- What diagnostics appear when temporal structure is needed?\n\n## Expected Diagnostics\n- MISSING_TIMESLICES when attempting explicit temporal resolution\n\n## Success Criteria\n- Approximate storage works OR documented schema gap for timeslices\n- Example: experiments/storage/model_storage_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:14:47.638328+11:00","updated_at":"2025-12-22T10:42:12.288843+11:00","closed_at":"2025-12-22T10:42:12.288843+11:00","close_reason":"Storage topology is expressible. Same-commodity I/O works (ELC → ELC with efficiency). Full temporal behavior requires timeslices (vedalang-6q7). See experiments/storage/model_storage_v1.veda.yaml"}
{"id":"vedalang-1ex","title":"DC2: Add renewable plant sharing output commodity","description":"Design challenge 2: Thermal + renewable plant both producing ELC. Tests multiple processes sharing a commodity.","acceptance_criteria":"- [ ] Model has PP_CCGT (gas) + PP_WIND (wind) both outputting ELC\n- [ ] Both processes appear in `~FI_PROCESS` with correct Sets\n- [ ] Both have correct `~FI_T` entries (thermal has efficiency, renewable does not)\n- [ ] Passes xl2times validation\n- [ ] Create golden fixture `vedalang/examples/dc2_thermal_renewable.veda.yaml`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.719917+11:00","updated_at":"2025-12-21T20:16:28.901359+11:00","closed_at":"2025-12-21T20:16:28.901359+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-1ex","depends_on_id":"vedalang-j9f","type":"blocks","created_at":"2025-12-21T17:59:08.366363+11:00","created_by":"gre538"}]}
{"id":"vedalang-1lb","title":"P2-06: Ergonomic improvements based on authoring friction","description":"## Goal\nAddress the highest-pain ergonomic issues discovered while authoring MiniSystem.\n\n## Process\n1. Review friction points documented in `docs/minisystem_friction.md` (created in P2-04)\n2. Prioritize by pain level and implementation cost\n3. Implement top 3-5 improvements\n\n## Candidate Improvements (from Oracle analysis)\n\n### 1. List normalization for sets\nAllow both:\n```yaml\nsets: [ELE]      # array form\nsets: ELE        # string form (normalized to array)\n```\nImplement in compiler with simple normalization.\n\n### 2. Constraint scope field\nAdd optional `scope` field to constraints:\n```yaml\nconstraints:\n  - name: CO2_CAP\n    type: emission_cap\n    scope: all_regions    # or 'per_region'\n    commodity: CO2\n    limit: 100\n```\nMaps to `uc_sets` R_E configuration.\n\n### 3. Timeslice fraction validation\nAdd compiler check:\n```python\nif abs(sum(fractions.values()) - 1.0) \u003e 1e-6:\n    raise SemanticError(\n        f\"Timeslice fractions sum to {sum(fractions.values())}, expected 1.0\"\n    )\n```\n\n### 4. Better demand modeling sugar\nConsider:\n- Validate demand_projection targets a DEM-type commodity (already in P2-02)\n- Add optional shorthand for common demand pattern:\n```yaml\ndemands:\n  - name: RSD\n    unit: PJ\n    trajectory:\n      \"2020\": 100\n      \"2050\": 160\n```\nExpands to: DEM commodity + DEMO process + demand_projection scenario.\n\n### 5. Default units by commodity type\nIf `unit` omitted:\n- energy → PJ\n- emission → Mt\n- demand → PJ\nWith warning: \"Commodity 'ELC' missing unit, defaulting to PJ\"\n\n## Deliverables\n- Schema changes (if any)\n- Compiler changes\n- Updated tests\n- Close `docs/minisystem_friction.md` issues\n\n## Acceptance Criteria\n- [ ] Friction points reviewed\n- [ ] Top 3-5 improvements implemented\n- [ ] MiniSystem updated if syntax changes\n- [ ] All tests pass\n\n## Dependencies\n- P2-04: MiniSystem implementation (source of friction points)\n\n## Parent\nvedalang-93s","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T16:37:59.173354+11:00","updated_at":"2025-12-23T11:43:32.192855+11:00","closed_at":"2025-12-23T11:43:32.192855+11:00","close_reason":"Implemented 3 ergonomic improvements: (1) shorthand input/output syntax, (2) default commodity units, (3) enhanced schema descriptions. 9 new tests. See docs/ergonomic_improvements.md"}
{"id":"vedalang-1uu","title":"Explore Transmission Within a Region","description":"## Primitive: Transmission\n**Parent:** vedalang-fq8\n\n## Intent\nRepresenting transmission losses or constraints within a region (HV vs LV).\n\n## Experiment Plan\n1. Model separate commodities: ELC_HV, ELC_LV\n2. Transmission process with losses via efficiency\n3. Test capacity limitations via costs\n\n## Key Questions\n- Can basic grid structure be represented with current constructs?\n- What additional attributes needed for constraints?\n\n## Expected Result\n- Likely expressible with current schema (separate commodities + processes)\n\n## Success Criteria\n- veda_check SUCCESS with transmission model\n- Example: experiments/transmission/model_transmission_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:15:51.573878+11:00","updated_at":"2025-12-22T12:09:33.623964+11:00","closed_at":"2025-12-22T12:09:33.623964+11:00","close_reason":"Exploration complete. Transmission is fully expressible with current schema - it's a modeling pattern using separate commodities (ELC_HV, ELC_LV) and processes with efficiency \u003c 1 for losses. No schema changes needed. See experiments/transmission/model_transmission_v1.veda.yaml"}
{"id":"vedalang-2bg","title":"xl2times: graceful handling and diagnostics for missing ~BOOKREGIONS_MAP","description":"xl2times crashes with 'ValueError: too few items in iterable' when ~BOOKREGIONS_MAP is missing. The crash is in transforms.fill_in_column_defaults calling utils.single_table(), which uses more_itertools.one.\n\n**Root cause**: transforms.py line ~150 assumes ~BOOKREGIONS_MAP exists.\n\n**Fix**:\n- Replace utils.single_table() with safe lookup (next(..., None))\n- When missing: emit MISSING_REQUIRED_TABLE diagnostic with severity=error\n- Fall back to model.internal_regions so pipeline continues\n- Ensure diagnostics.json is produced\n\n**Acceptance criteria**:\n- [ ] Missing ~BOOKREGIONS_MAP emits structured diagnostic, not crash\n- [ ] Diagnostic has code=MISSING_REQUIRED_TABLE, context={table_tag, table_kind}\n- [ ] Pipeline continues and produces diagnostics.json\n- [ ] xl2times exits non-zero when errors present\n- [ ] Test covers missing table case","status":"closed","issue_type":"task","created_at":"2025-12-21T18:11:09.616693+11:00","updated_at":"2025-12-21T18:15:42.674738+11:00","closed_at":"2025-12-21T18:15:42.674738+11:00","close_reason":"Closed","labels":["crash-fix","diagnostics","xl2times"]}
{"id":"vedalang-2cr","title":"Explore Fuel Supply \u0026 Resource Limits","description":"## Primitive: Fuel Supply\n**Parent:** vedalang-fq8\n\n## Intent\nUpstream resource supply (fuel extraction) with bounds or costs.\n\n## Experiment Plan\n1. Define fuel commodities with extraction process\n2. Approximate costs via price parameters\n3. Test if resource limits can be represented\n\n## Key Questions\n- Can supply limits be expressed via capacity or availability?\n- What TIMES tables handle resource constraints?\n\n## Success Criteria\n- Fuel supply works OR documented gap for resource bounds\n- Example: experiments/fuel_supply/model_fuel_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:15:11.768595+11:00","updated_at":"2025-12-22T11:03:24.189393+11:00","closed_at":"2025-12-22T11:03:24.189393+11:00","close_reason":"Exploration complete. Supply topology works (process with no inputs). Cost and bound parameters need schema extensions - see vedalang-m2k (costs), vedalang-86j (activity cost), vedalang-014 (bounds). See experiments/handoff/session_2025-12-22_fuel_supply.yaml"}
{"id":"vedalang-381","title":"Explore Capacity Bounds \u0026 Build Limits","description":"## Primitive: Capacity Bounds\n**Parent:** vedalang-fq8\n\n## Intent\nUpper/lower bounds on installed capacity or build rates (NCAP_BND, CAP_BND).\n\n## Experiment Plan\n1. **Approximate:** Emulate via process availability or proxy costs\n2. **Advanced:** Attempt to emit capacity-bound tables\n\n## Key Questions\n- Which TIMES tables are needed for NCAP_BND/CAP_BND?\n- Can bounds be approximated without explicit attributes?\n\n## Expected Schema Extension\n- New optional attributes on process for capacity bounds\n\n## Success Criteria\n- Workaround documented OR schema proposal for bounds\n- Example: experiments/capacity_bounds/model_bounds_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:15:24.842729+11:00","updated_at":"2025-12-22T11:12:31.891272+11:00","closed_at":"2025-12-22T11:12:31.891272+11:00","close_reason":"Exploration complete. All capacity bound patterns validated (CAP_BND, NCAP_BND with UP/LO/FX limtypes, time-varying). Expanded scope added to vedalang-014 via comment. See experiments/handoff/session_2025-12-22_capacity_bounds.yaml"}
{"id":"vedalang-4t8","title":"P2-07: Wire MiniSystem as golden CI test","description":"## Goal\nAdd MiniSystem as a golden end-to-end test in the test suite, ensuring future changes don't break a working model.\n\n## Implementation\n\n### 1. Create test file\n`tests/test_minisystem_golden.py`:\n```python\n\"\"\"Golden test for MiniSystem model.\"\"\"\nimport subprocess\nfrom pathlib import Path\n\nimport pytest\n\nPROJECT_ROOT = Path(__file__).parent.parent\nMINISYSTEM = PROJECT_ROOT / \"vedalang\" / \"examples\" / \"minisystem.veda.yaml\"\n\n\ndef test_minisystem_compiles():\n    \"\"\"MiniSystem should compile to valid TableIR.\"\"\"\n    result = subprocess.run(\n        [\"uv\", \"run\", \"vedalang\", \"compile\", str(MINISYSTEM)],\n        capture_output=True,\n        text=True,\n    )\n    assert result.returncode == 0, f\"Compile failed: {result.stderr}\"\n\n\ndef test_minisystem_validates():\n    \"\"\"MiniSystem should pass xl2times validation.\"\"\"\n    result = subprocess.run(\n        [\"uv\", \"run\", \"veda_check\", str(MINISYSTEM), \"--from-vedalang\", \"--json\"],\n        capture_output=True,\n        text=True,\n    )\n    # Check no errors (warnings OK)\n    import json\n    output = json.loads(result.stdout)\n    errors = [d for d in output.get(\"diagnostics\", []) if d[\"severity\"] == \"error\"]\n    assert len(errors) == 0, f\"Validation errors: {errors}\"\n\n\ndef test_minisystem_exercises_all_features():\n    \"\"\"Verify MiniSystem uses all major VedaLang features.\"\"\"\n    import yaml\n    with open(MINISYSTEM) as f:\n        model = yaml.safe_load(f)[\"model\"]\n    \n    # Check all features present\n    assert len(model[\"regions\"]) \u003e= 2, \"Should have multiple regions\"\n    assert \"timeslices\" in model, \"Should have timeslices\"\n    assert \"trade_links\" in model, \"Should have trade links\"\n    assert \"scenarios\" in model, \"Should have scenarios\"\n    assert \"constraints\" in model, \"Should have constraints\"\n    \n    # Check variety\n    comm_types = {c[\"type\"] for c in model[\"commodities\"]}\n    assert comm_types \u003e= {\"energy\", \"demand\", \"emission\"}, \"Should have all commodity types\"\n    \n    scenario_types = {s[\"type\"] for s in model[\"scenarios\"]}\n    assert scenario_types \u003e= {\"commodity_price\", \"demand_projection\"}, \"Should have both scenario types\"\n    \n    constraint_types = {c[\"type\"] for c in model[\"constraints\"]}\n    assert constraint_types \u003e= {\"emission_cap\", \"activity_share\"}, \"Should have both constraint types\"\n```\n\n### 2. Update CI\nEnsure `uv run pytest tests/test_minisystem_golden.py` runs in CI pipeline.\n\n### 3. Document in AGENTS.md\nAdd MiniSystem as reference model:\n```markdown\n## Reference Models\n- `vedalang/examples/minisystem.veda.yaml` - Full-featured toy model for validation\n```\n\n## Acceptance Criteria\n- [ ] test_minisystem_golden.py created\n- [ ] All 3 tests pass\n- [ ] Tests run as part of `uv run pytest tests/`\n- [ ] AGENTS.md updated\n\n## Dependencies\n- P2-04: MiniSystem implementation\n\n## Parent\nvedalang-93s","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T16:38:23.94545+11:00","updated_at":"2025-12-23T10:14:25.476985+11:00","closed_at":"2025-12-23T10:14:25.476985+11:00","close_reason":"Golden tests in tests/test_minisystem_golden.py - 18 passing"}
{"id":"vedalang-5dw","title":"P2-03: Design MiniSystem model specification","description":"## Goal\nDesign a detailed specification for MiniSystem - a non-trivial toy model that exercises all VedaLang features.\n\n## MiniSystem Scope\n\n### Regions (2)\n- `NORTH` - industrial region, more gas capacity\n- `SOUTH` - sunnier region, more solar potential\n\n### Commodities (7)\n| Name | Type | Unit | Description |\n|------|------|------|-------------|\n| ELC | energy | PJ | Electricity |\n| NG | energy | PJ | Natural Gas |\n| COAL | energy | PJ | Coal |\n| HEAT | energy | PJ | District heat |\n| RSD | demand | PJ | Residential demand |\n| TRN | demand | PJ | Transport demand |\n| CO2 | emission | Mt | Carbon dioxide |\n\n### Timeslices (4)\n- Seasons: `SU` (Summer), `WI` (Winter)\n- Daynite: `D` (Day), `N` (Night)\n- Fractions: 0.25 each (equal distribution)\n\n### Processes (10-12)\n\n**Power generation:**\n| Process | Sets | Inputs | Outputs | Notes |\n|---------|------|--------|---------|-------|\n| PP_CCGT | ELE | NG | ELC, CO2 | Combined cycle, tests multi-output |\n| PP_COAL | ELE | COAL | ELC, CO2 | Coal plant |\n| PP_WIND | ELE | - | ELC | Wind, no fuel input |\n| PP_SOLAR | ELE | - | ELC | Solar, no fuel input |\n\n**Fuel supply:**\n| Process | Sets | Outputs | Notes |\n|---------|------|---------|-------|\n| IMP_NG | IMP | NG | Gas import with cost |\n| IMP_COAL | IMP | COAL | Coal import with cost |\n\n**Heat:**\n| Process | Sets | Inputs | Outputs | Notes |\n|---------|------|--------|---------|-------|\n| BOILER_NG | HET | NG | HEAT, CO2 | Gas boiler |\n\n**Demand devices:**\n| Process | Sets | Inputs | Outputs | Notes |\n|---------|------|--------|---------|-------|\n| DEM_RSD | DMD | ELC, HEAT | RSD | Residential, tests DEMO PCG |\n| DEM_TRN | DMD | ELC | TRN | Transport |\n\n### Trade Links (2)\n| Origin | Destination | Commodity | Bidirectional | Efficiency |\n|--------|-------------|-----------|---------------|------------|\n| NORTH | SOUTH | ELC | true | 0.98 |\n| NORTH | SOUTH | NG | true | 1.0 (default) |\n\n### Scenarios (2)\n1. **BaseDemand** (demand_projection)\n   - Commodity: RSD\n   - Values: 2020→100, 2030→120, 2050→160\n\n2. **CO2Price** (commodity_price)\n   - Commodity: CO2\n   - Values: 2020→30, 2030→50, 2050→100 (€/tCO2)\n\n### Constraints (2)\n1. **CO2_CAP** (emission_cap)\n   - Commodity: CO2\n   - Years: 2020→100, 2040→50 (declining cap)\n   - Interpolation: interp_extrap\n\n2. **REN_TARGET** (activity_share)\n   - Commodity: ELC\n   - Processes: [PP_WIND, PP_SOLAR]\n   - minimum_share: 0.30\n\n### Model Parameters\n- start_year: 2020\n- time_periods: [10, 10, 10, 10] (2020-2060)\n\n## Features Exercised\n- [x] Multiple regions\n- [x] All commodity types (energy, demand, emission)\n- [x] Timeslices with fractions\n- [x] Process efficiency and topology\n- [x] Multi-output processes (CO2 emissions)\n- [x] PCG inference (various cases)\n- [x] Fuel supply with cost\n- [x] Trade links with efficiency\n- [x] Both scenario types\n- [x] Both constraint types\n- [x] Time-series interpolation\n\n## Deliverable\nA markdown document: `docs/minisystem_spec.md` with:\n- Full model specification\n- Expected PCG for each process\n- Expected TableIR structure\n- Known limitations / future extensions\n\n## Acceptance Criteria\n- [ ] docs/minisystem_spec.md created\n- [ ] All VedaLang features covered\n- [ ] Clear enough for implementation in P2-04\n\n## Dependencies\n- P2-01 (PCG inference) - to understand PCG behavior\n- P2-02 (semantic validation) - to catch errors during design\n\n## Parent\nvedalang-93s","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T16:36:40.177746+11:00","updated_at":"2025-12-23T10:14:14.794077+11:00","closed_at":"2025-12-23T10:14:14.794077+11:00","close_reason":"Spec created at docs/minisystem_spec.md"}
{"id":"vedalang-5rj","title":"Document agent design workflow in AGENTS.md","description":"Update AGENTS.md with the agent design workflow, phases, and guardrails.","acceptance_criteria":"- [ ] Document the 5 phases (P0-P4)\n- [ ] Document design challenges (DC1-DC5)\n- [ ] Document failure handling process\n- [ ] Document guardrails (golden fixtures, schema policy)\n- [ ] Document the design loop: prototype at TableIR → validate → lift to VedaLang","status":"closed","issue_type":"task","created_at":"2025-12-21T17:57:35.722151+11:00","updated_at":"2025-12-21T20:02:45.817687+11:00","closed_at":"2025-12-21T20:02:45.817687+11:00","close_reason":"Closed"}
{"id":"vedalang-5zv","title":"Add trade link efficiency (IRE_FLO) support","description":"The trade_links efficiency field is in the schema but not yet compiled.\n\nWhen efficiency \u003c 1.0 is specified, the compiler should emit ~TFM_INS rows with attribute=IRE_FLO to specify transport losses.\n\nExample:\n```yaml\ntrade_links:\n  - origin: REG1\n    destination: REG2\n    commodity: ELC\n    bidirectional: true\n    efficiency: 0.98  # 2% loss - NOT YET COMPILED\n```\n\nLower priority - basic trade topology works without it.","notes":"Implemented trade link efficiency via ~FI_T with EFF attribute. Uses matrix format with explicit process names to enable targeting. Added test_trade_link_efficiency test.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T14:03:14.389933+11:00","updated_at":"2025-12-22T15:05:22.059945+11:00","closed_at":"2025-12-22T15:05:22.059947+11:00","dependencies":[{"issue_id":"vedalang-5zv","depends_on_id":"vedalang-ilt","type":"discovered-from","created_at":"2025-12-22T14:03:14.391014+11:00","created_by":"gre538"}]}
{"id":"vedalang-6q7","title":"Explore Time-Slicing / Temporal Structure","description":"## Primitive: Timeslices\n**Parent:** vedalang-fq8\n\n## Intent\nExplicit representation of multiple time slices (seasons, time-of-day).\n\n## Experiment Plan\n1. Attempt to design model with time-structured information\n2. Observe MISSING_TIMESLICES diagnostics\n3. Document minimal TIMES table requirements\n\n## Key Questions\n- What is the minimal table set for timeslice support?\n- How do timeslices interact with storage and demand?\n\n## Expected Schema Extension\n- timeslices section in VedaLang model\n- Rules for mapping to TIMES ~TIMESLICE tables\n\n## Success Criteria\n- Documented diagnostic pattern AND schema proposal\n- Example: experiments/timeslices/model_timeslice_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:15:38.366841+11:00","updated_at":"2025-12-22T11:28:32.747268+11:00","closed_at":"2025-12-22T11:28:32.747268+11:00","close_reason":"Exploration complete. Validated timeslice structure with zero warnings/errors. Requires ~TIMESLICES table + ~TFM_INS with YRFR. Implementation tracked in vedalang-jno. See experiments/timeslices/ and experiments/handoff/session_2025-12-22_timeslices.yaml"}
{"id":"vedalang-6qs","title":"P2-05: Add time-varying process attributes (time_series)","description":"## Goal\nWire the existing `time_series` schema definition into process attributes, enabling cost decline curves and efficiency improvements over time.\n\n## Background\nThe schema already defines `time_series` but it's unused for processes. Practical models need:\n- Learning curves (declining investment costs for renewables)\n- Efficiency improvements over time\n- Time-varying O\u0026M costs\n\n## Schema Changes\nAdd to `process` definition:\n```json\n\"invcost_series\": { \n  \"$ref\": \"#/$defs/time_series\",\n  \"description\": \"Time-varying investment cost (NCAP_COST). Overrides scalar invcost.\"\n},\n\"efficiency_series\": {\n  \"$ref\": \"#/$defs/time_series\",\n  \"description\": \"Time-varying efficiency (EFF). Overrides scalar efficiency.\"\n},\n\"fixom_series\": {\n  \"$ref\": \"#/$defs/time_series\",\n  \"description\": \"Time-varying fixed O\u0026M (FOM). Overrides scalar fixom.\"\n}\n```\n\n## Compiler Changes\n\n### 1. Validation\nIf both scalar and series are present, error:\n```\nSemanticError: Process 'PP_SOLAR' has both 'invcost' (800) and 'invcost_series' defined. Use only one.\n```\n\n### 2. Expansion\nFor each `*_series` field:\n```python\nif 'invcost_series' in process:\n    series = process['invcost_series']\n    expanded = _expand_series_to_years(\n        series['values'], \n        model_years, \n        series['interpolation']\n    )\n    for year, value in expanded.items():\n        emit_row(techname=process['name'], year=year, invcost=value)\n```\n\n### 3. TableIR emission\nEmit year-specific rows in ~FI_T:\n```yaml\n- techname: PP_SOLAR\n  year: 2020\n  invcost: 1000\n- techname: PP_SOLAR\n  year: 2030\n  invcost: 600\n- techname: PP_SOLAR\n  year: 2050\n  invcost: 300\n```\n\n## Example Usage\n```yaml\nprocesses:\n  - name: PP_SOLAR\n    sets: [ELE]\n    outputs:\n      - commodity: ELC\n    invcost_series:\n      interpolation: interp_extrap\n      values:\n        \"2020\": 1000\n        \"2030\": 600\n        \"2050\": 300\n```\n\n## Test Cases\n1. Solar plant with declining invcost_series\n2. Efficiency improvement over time\n3. Error when both scalar and series present\n4. Correct interpolation for missing years\n\n## Integration with MiniSystem\nAdd to at least one process (e.g., PP_SOLAR) in minisystem.veda.yaml to demonstrate the feature.\n\n## Acceptance Criteria\n- [ ] Schema updated with `invcost_series`, `efficiency_series`, `fixom_series`\n- [ ] Compiler expands series to year-specific rows\n- [ ] Validation prevents scalar + series conflict\n- [ ] Tests for all new functionality\n- [ ] At least one MiniSystem process uses a series\n\n## Dependencies\n- P2-04: MiniSystem implementation (to demonstrate usage)\n\n## Parent\nvedalang-93s","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-22T16:37:32.888559+11:00","updated_at":"2025-12-23T11:34:24.771731+11:00","closed_at":"2025-12-23T11:34:24.771731+11:00","close_reason":"Implemented time-varying process attributes (invcost, efficiency, fixom, varom, life, cost, availability_factor). Schema already supported oneOf. Compiler now expands to year-indexed rows with interpolation codes. 4 tests added."}
{"id":"vedalang-6ww","title":"Implement veda_emit_excel (TableIR to Excel emitter)","description":"Build the T2 tool: TableIR → Excel emitter. This is the experimentation layer for VEDA patterns.\n\n## Location:\n`tools/veda_emit_excel/`\n\n## Components:\n\n1. **Library** (`tools/veda_emit_excel/__init__.py`):\n   ```python\n   def emit_excel(tableir: dict, out_dir: Path) -\u003e list[Path]:\n       '''Convert TableIR dict to Excel files, return paths created.'''\n   ```\n\n2. **CLI** (`tools/veda_emit_excel/cli.py`):\n   ```bash\n   veda_emit_excel tables.yaml --out output_dir/\n   veda_emit_excel tables.yaml --out model.xlsx  # single file mode\n   ```\n\n3. **Entry point** in `pyproject.toml`:\n   ```toml\n   [project.scripts]\n   veda_emit_excel = \"tools.veda_emit_excel.cli:main\"\n   ```\n\n## Functionality:\n- Load TableIR from YAML or JSON\n- Validate against `tableir.schema.json` (fail fast on invalid input)\n- Use `openpyxl` to create workbooks\n- For each file in TableIR:\n  - Create workbook at specified path\n  - For each sheet, create worksheet\n  - For each table, write tag row then header row then data rows\n- Handle VEDA table format quirks (tag in first cell, etc.)\n\n## Acceptance:\n- `uv run veda_emit_excel vedalang/examples/tableir_minimal.yaml --out /tmp/test/`\n- Creates valid Excel file(s) that xl2times can read\n- Schema validation errors produce clear messages","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-21T16:42:44.080281+11:00","updated_at":"2025-12-21T17:19:13.716944+11:00","closed_at":"2025-12-21T17:19:13.716944+11:00","close_reason":"Closed","labels":["emitter","phase-2","tooling"],"dependencies":[{"issue_id":"vedalang-6ww","depends_on_id":"vedalang-l5j","type":"blocks","created_at":"2025-12-21T16:42:44.081432+11:00","created_by":"gre538"}]}
{"id":"vedalang-73g","title":"xl2times: always produce diagnostics.json on unexpected errors","description":"When xl2times encounters an uncaught exception, it terminates without writing diagnostics.json even if --diagnostics-json was requested. This breaks the feedback loop for VedaLang.\n\n**Fix**:\n- Wrap main pipeline in try/except in run()\n- On Exception: emit INTERNAL_ERROR diagnostic via get_collector().error()\n- Always write diagnostics.json if flag was provided\n- Include exception type/message in diagnostic context\n- Exit non-zero\n\n**Acceptance criteria**:\n- [ ] Uncaught exceptions produce diagnostics.json with INTERNAL_ERROR\n- [ ] Diagnostic includes exception_type and message in context\n- [ ] Process exits non-zero\n- [ ] Test simulates exception and verifies diagnostics.json created","status":"closed","issue_type":"task","created_at":"2025-12-21T18:11:23.177764+11:00","updated_at":"2025-12-21T18:17:48.844423+11:00","closed_at":"2025-12-21T18:17:48.844423+11:00","close_reason":"Closed","labels":["diagnostics","error-handling","xl2times"]}
{"id":"vedalang-79r","title":"xl2times: Make all input validation errors fail gracefully with diagnostics","description":"When running xl2times on VedaLang-emitted input decks, we still get hard failures (KeyError, AttributeError, etc.) for missing/malformed input data. These should all emit structured diagnostics instead.\n\n**Current state**: After our recent fixes, xl2times emits diagnostics for missing tables. But we still get:\n- KeyError: 'tact' (column name case mismatch)\n- Other crashes from missing columns or malformed data\n\n**Goal**: Every input validation failure should:\n1. Emit a structured diagnostic with specific code (MISSING_COLUMN, INVALID_VALUE, etc.)\n2. Continue processing where possible to collect more diagnostics\n3. Exit non-zero with complete diagnostics.json\n\n**Hard failures should ONLY indicate xl2times bugs, not input problems.**\n\n**Approach**:\n1. Run veda_check on mini_plant.veda.yaml, capture the INTERNAL_ERROR\n2. Trace the KeyError to its source in xl2times\n3. Add defensive handling + diagnostic emission\n4. Repeat until no more INTERNAL_ERRORs from input validation\n5. Add tests for each case fixed\n\n**Acceptance criteria**:\n- [ ] mini_plant.veda.yaml produces only MISSING_* diagnostics, no INTERNAL_ERROR\n- [ ] Each missing column/table has specific diagnostic code\n- [ ] All diagnostics have actionable messages\n- [ ] Tests cover each fixed case","status":"closed","issue_type":"task","created_at":"2025-12-21T18:37:59.42649+11:00","updated_at":"2025-12-21T19:06:34.611795+11:00","closed_at":"2025-12-21T19:06:34.611795+11:00","close_reason":"Closed","labels":["diagnostics","hardening","input-validation","xl2times"]}
{"id":"vedalang-86j","title":"Add activity cost (cost) for supply processes","description":"Schema extension P-costs-002: Add activity cost parameter to process schema.\n\nChanges needed:\n1. Add to process schema: cost (number) - activity cost per unit output\n2. Emit as 'cost' column in ~FI_T\n\nExample:\n```yaml\nprocesses:\n  - name: IMP_NG\n    sets: [IMP]\n    outputs:\n      - commodity: NG\n    cost: 5.0  # M€/PJ\n```\n\nMaps to TIMES ACT_COST parameter.\n\nSee: experiments/handoff/session_2025-12-22_fuel_supply.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T11:03:07.189625+11:00","updated_at":"2025-12-22T12:48:46.707881+11:00","closed_at":"2025-12-22T12:48:46.707881+11:00","close_reason":"Implemented. Added cost field to process schema for supply process activity costs. Compiler emits to ~FI_T. Test added. See vedalang/examples/mini_plant_with_costs.veda.yaml","dependencies":[{"issue_id":"vedalang-86j","depends_on_id":"vedalang-2cr","type":"discovered-from","created_at":"2025-12-22T11:03:07.190553+11:00","created_by":"gre538"}]}
{"id":"vedalang-87e","title":"Explore Trade Between Regions","description":"## Primitive: Trade\n**Parent:** vedalang-fq8\n\n## Intent\nExplicit inter-region energy exchange (IRE-type processes).\n\n## Experiment Plan\n1. Extend DC5 two-region model\n2. Attempt trade as mirrored processes or pseudo-processes\n3. Observe IRE-related failures\n\n## Key Questions\n- What TIMES tables are needed for IRE processes?\n- Can trade be approximated without explicit IRE support?\n\n## Expected Schema Extension\n- Explicit trade/IRE construct\n- Region-pair definitions\n\n## Success Criteria\n- Workaround documented OR trade construct proposal\n- Example: experiments/trade/model_trade_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:16:03.913405+11:00","updated_at":"2025-12-22T12:23:18.943207+11:00","closed_at":"2025-12-22T12:23:18.943207+11:00","close_reason":"Exploration complete. Trade requires schema extension - current VedaLang cannot express bi-regional topology. Validated VEDA pattern with working miniveda2_with_trade fixture. Implementation tracked in vedalang-ilt. See experiments/handoff/session_2025-12-22_trade.yaml"}
{"id":"vedalang-8d0","title":"veda_emit_excel: emit uc_sets metadata for ~UC_T tables","description":"xl2times generate_uc_properties expects uc_sets metadata from table headers to determine region/period/timeslice actions.\n\nFrom transforms.py:\n- R_E, R_S: Region specification (each, sum)\n- T_E, T_SUM: Period handling\n- TS_N, TS_SUM: Timeslice handling\n\nCurrent state:\n- VedaLang _compile_constraints() correctly emits ~UC_T rows\n- veda_emit_excel doesn't emit uc_sets metadata in table headers\n- xl2times skips proper UC expansion without this metadata\n\nNeeds investigation:\n1. How does VEDA Excel encode uc_sets in table headers?\n2. Extend TableIR schema to support table-level metadata\n3. Update veda_emit_excel to emit this metadata","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T15:47:49.693301+11:00","updated_at":"2025-12-22T16:00:04.16676+11:00","closed_at":"2025-12-22T16:00:04.16676+11:00","close_reason":"Implemented uc_sets metadata emission. TableIR schema extended, veda_emit_excel emits ~UC_SETS: declarations, compiler sets defaults for constraint tables."}
{"id":"vedalang-93s","title":"Phase 2: MiniSystem Stress Test","description":"## Goal\nBuild a non-trivial MiniSystem model in VedaLang that exercises all existing features, validated end-to-end via veda_check. This validates the language design with a real (if small) model.\n\n## Success Criteria\n- MiniSystem.veda.yaml exists and passes veda_check validation\n- All existing VedaLang features are exercised\n- Golden test ensures future changes don't break the model\n- Ergonomic friction points are documented and addressed\n\n## Child Issues (in order)\n1. P2-01: Implement PCG inference\n2. P2-02: Add semantic cross-reference validation (including unit checks)\n3. P2-03: Design MiniSystem model specification\n4. P2-04: Implement MiniSystem model\n5. P2-05: Add time-varying process attributes (time_series)\n6. P2-06: Ergonomic improvements based on authoring friction\n7. P2-07: Wire MiniSystem as golden CI test\n\n## References\n- Oracle analysis from thread T-019b4486-26bd-704b-bdf1-a457880ff85c\n- pcg_investigation.md for PCG spec","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-22T16:35:16.559456+11:00","updated_at":"2025-12-22T16:35:16.559456+11:00"}
{"id":"vedalang-9df","title":"Explore User Constraints / Policy Constraints","description":"## Primitive: User Constraints\n**Parent:** vedalang-fq8\n\n## Intent\nUC-style user constraints linking activities/flows in custom equations.\n\n## Experiment Plan\n1. Attempt proxy constraints via costs, prices, capacity\n2. Observe missing-UC-table diagnostics\n3. Map concrete policy example to TIMES UC tables\n\n## Key Questions\n- What policies can be approximated with costs/prices?\n- What requires explicit UC tables?\n\n## Expected Schema Extension\n- Minimal UC support for common policy types\n\n## Success Criteria\n- Documented policy examples with/without UC needs\n- Example: experiments/user_constraints/model_uc_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:16:16.764163+11:00","updated_at":"2025-12-22T14:33:40.081532+11:00","closed_at":"2025-12-22T14:33:40.081532+11:00","close_reason":"Exploration complete. Documented UC table structure (UC_SETS, UC_T). Common patterns identified: emission_cap, activity_share. xl2times hit 'description' error - needs investigation. Implementation tracked in vedalang-vda. See experiments/user_constraints/README.md"}
{"id":"vedalang-9xy","title":"P2-Future: Scenario composition and variants","description":"## Goal\nEnable declarative scenario composition - combining multiple scenario files into bundles.\n\n## Use Case\nReal models often have:\n- Base demand scenario\n- Alternative policy scenarios (carbon tax, RPS, etc.)\n- Sensitivity variants (high/low fuel prices)\n\nModelers want to compose these: \"Run base demand + high carbon tax + low gas price\"\n\n## Possible Syntax\n```yaml\nscenario_bundles:\n  - name: HighAmbition\n    includes:\n      - BaseDemand\n      - HighCO2Tax\n      - AggressiveRenewable\n  - name: BAU\n    includes:\n      - BaseDemand\n      - LowCO2Tax\n```\n\n## Deferred because\n- Current single-scenario model is sufficient for validation\n- Composition requires understanding xl2times case handling\n- Should be informed by real workflow patterns\n\n## References\n- Oracle recommendation: \"Advanced 2\"\n\n## Parent\nvedalang-93s","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-22T16:38:53.519163+11:00","updated_at":"2025-12-22T16:38:53.519163+11:00"}
{"id":"vedalang-a65","title":"Build pattern expansion tool","description":"Implement tooling to expand patterns from the pattern library into VedaLang or TableIR.\n\n## Location:\n`tools/veda_patterns/`\n\n## Purpose:\nAllow agents to invoke patterns by name with parameters, getting valid VedaLang/TableIR output.\n\n## API:\n```python\nfrom tools.veda_patterns import expand_pattern\n\nresult = expand_pattern(\n    pattern_name='add_power_plant',\n    parameters={\n        'plant_name': 'PP_CCGT',\n        'fuel_commodity': 'NG',\n        'output_commodity': 'ELC',\n        'efficiency': 0.55\n    },\n    output_format='vedalang'  # or 'tableir'\n)\n```\n\n## CLI:\n```bash\nveda_pattern expand add_power_plant \\\n  --param plant_name=PP_CCGT \\\n  --param fuel_commodity=NG \\\n  --param output_commodity=ELC \\\n  --format vedalang\n```\n\n## Implementation:\n- Load patterns from `rules/patterns.yaml`\n- Use Jinja2 for template expansion\n- Validate expanded output against appropriate schema\n- Support both VedaLang and TableIR output formats\n\n## Tests:\n`tests/test_patterns_expand.py`:\n- Expand add_power_plant pattern\n- Validate output against schema\n- Full pipeline: expand → compile → emit → xl2times validate\n\n## Acceptance:\n- Pattern expansion produces valid VedaLang/TableIR\n- Missing required parameters raise clear errors\n- Default parameter values work correctly","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-21T16:44:38.96754+11:00","updated_at":"2025-12-21T17:43:02.561383+11:00","closed_at":"2025-12-21T17:43:02.561383+11:00","close_reason":"Closed","labels":["patterns","phase-5","tooling"],"dependencies":[{"issue_id":"vedalang-a65","depends_on_id":"vedalang-02l","type":"blocks","created_at":"2025-12-21T16:44:38.968957+11:00","created_by":"gre538"},{"issue_id":"vedalang-a65","depends_on_id":"vedalang-e0g","type":"blocks","created_at":"2025-12-21T16:44:38.969657+11:00","created_by":"gre538"}]}
{"id":"vedalang-a9m","title":"P2-Future: Units and dimension checking system","description":"## Goal\nAdd comprehensive unit/dimension checking to catch physical inconsistencies at compile time.\n\n## Scope (for later)\n- Define unit categories with conversion factors\n- Validate activity_unit vs input/output commodity units\n- Check efficiency definitions are dimensionally correct\n- Warn on unusual unit combinations\n\n## Rationale\nDeferred because:\n- P2-02 adds basic unit category warnings\n- Full dimension checking is complex\n- Should be informed by real modeling friction\n\n## References\n- Oracle recommendation: \"Advanced 1\"\n- P2-02 implements initial unit category checks\n\n## Parent\nvedalang-93s","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-22T16:38:39.521129+11:00","updated_at":"2025-12-22T16:38:39.521129+11:00"}
{"id":"vedalang-a9w","title":"DC3: Introduce emission commodity and emission factor","description":"Design challenge 3: Gas plant emits CO2 per unit fuel burned. Forces schema extension for emissions.","acceptance_criteria":"- [ ] CO2 commodity defined with type: emission\n- [ ] PP_CCGT has associated CO2 output with emission factor\n- [ ] Valid `~FI_COMM` entry for CO2 (Csets: ENV)\n- [ ] Valid `~FI_T` entry linking process to CO2 emission\n- [ ] xl2times accepts the emission structure\n- [ ] Create golden fixture `vedalang/examples/dc3_with_emissions.veda.yaml`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:57:35.720146+11:00","updated_at":"2025-12-21T20:24:16.156813+11:00","closed_at":"2025-12-21T20:24:16.156813+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-a9w","depends_on_id":"vedalang-1ex","type":"blocks","created_at":"2025-12-21T17:59:13.698656+11:00","created_by":"gre538"}]}
{"id":"vedalang-alr","title":"P2-02: Add semantic cross-reference validation with unit checks","description":"## Goal\nAdd a semantic validation phase in the compiler that catches cross-reference errors and unit mismatches before emitting TableIR.\n\n## Rationale\nJSON Schema enforces shape, but not:\n- References to non-existent commodities/processes/regions\n- Unit compatibility between commodities and processes\n- Semantic constraints (e.g., demand_projection must target DEM commodity)\n\n## Implementation\n\n### 1. Add `validate_cross_references()` function\nCalled at start of `compile_vedalang_to_tableir()`, before any emission.\n\n### 2. Reference checks\nBuild sets from model:\n```python\ncommodities = {c['name']: c for c in model.get('commodities', [])}\nprocesses = {p['name'] for p in model.get('processes', [])}\nregions = set(model.get('regions', []))\n```\n\nValidate:\n- [ ] Each `flow.commodity` in inputs/outputs exists in commodities\n- [ ] Each `constraint.commodity` exists in commodities\n- [ ] Each `constraint.processes[]` exists in processes\n- [ ] Each `trade_link.origin/destination` exists in regions\n- [ ] Each `scenario.commodity` exists in commodities\n- [ ] `demand_projection` scenario targets a `type: demand` commodity\n- [ ] `commodity_price` scenario targets a non-demand commodity\n\n### 3. Unit compatibility checks\nDefine unit categories:\n```python\nENERGY_UNITS = {'PJ', 'TJ', 'GJ', 'MWh', 'GWh', 'TWh', 'MTOE', 'KTOE'}\nPOWER_UNITS = {'GW', 'MW', 'kW', 'TW'}\nMASS_UNITS = {'Mt', 'kt', 't', 'Gt'}\n```\n\nValidate:\n- [ ] Process `activity_unit` is energy-compatible for energy processes\n- [ ] Process `capacity_unit` is power-compatible\n- [ ] Warn if commodity unit doesn't match typical category for its type:\n  - energy → ENERGY_UNITS\n  - emission → MASS_UNITS\n  - demand → flexible (warn if unusual)\n\n### 4. Error messages\nClear, actionable messages:\n```\nSemanticError: Unknown commodity 'ELC1' in process 'PP_CCGT' inputs[0]\n  Hint: Did you mean 'ELC'?\n\nSemanticError: demand_projection scenario 'BaseDemand' targets commodity 'NG' which has type 'energy', not 'demand'\n  \nUnitWarning: Process 'PP_CCGT' has activity_unit 'kg' which is not a recognized energy unit\n  Expected one of: PJ, TJ, GJ, MWh, GWh, TWh\n```\n\n### 5. Configuration\n- Validation runs by default\n- Add `validate: bool = True` parameter to skip if needed\n- Unit checks are warnings, not errors (models may have custom units)\n\n## Acceptance Criteria\n- [ ] `validate_cross_references()` implemented\n- [ ] All reference checks pass for existing examples\n- [ ] Unit category checks with warnings\n- [ ] Tests for each error type\n- [ ] Existing tests still pass\n\n## Dependencies\nNone\n\n## Parent\nvedalang-93s","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T16:36:06.557692+11:00","updated_at":"2025-12-22T17:59:53.433387+11:00","closed_at":"2025-12-22T17:59:53.433389+11:00"}
{"id":"vedalang-b4b","title":"Design and implement tableir.schema.json","description":"Define the JSON Schema for TableIR - the intermediate representation between VedaLang and Excel.\n\n## Schema location:\n`vedalang/schema/tableir.schema.json`\n\n## Required structure (per AGENTS.md):\n```yaml\nfiles:\n  - path: base/base.xlsx\n    sheets:\n      - name: \"Base\"\n        tables:\n          - tag: \"~FI_PROCESS\"\n            rows:\n              - { PRC: \"PP_CCGT\", Sets: \"ELE\", TACT: \"PJ\", TCAP: \"GW\" }\n          - tag: \"~FI_T\"\n            rows:\n              - { PRC: \"PP_CCGT\", COM_IN: \"NG\", COM_OUT: \"ELC\", EFF: 0.55 }\n```\n\n## Schema design:\n- Top-level: `files[]` array\n- Each file: `path` (string), `sheets[]` array\n- Each sheet: `name` (string), `tables[]` array\n- Each table: `tag` (string starting with ~), `rows[]` array\n- Rows: objects with string keys (VEDA column names), values can be string/number\n\n## Minimal tags to support initially:\n- `~FI_PROCESS` - process definitions\n- `~FI_T` - process topology (inputs/outputs/efficiency)\n- `~FI_COMM` - commodity definitions\n\n## Acceptance:\n- Schema validates the example TableIR from AGENTS.md\n- Schema is well-documented with descriptions\n- Test validates example against schema","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:42:10.718395+11:00","updated_at":"2025-12-21T16:55:29.769981+11:00","closed_at":"2025-12-21T16:55:29.769981+11:00","close_reason":"Closed","labels":["phase-1","schema","tableir"],"dependencies":[{"issue_id":"vedalang-b4b","depends_on_id":"vedalang-wrz","type":"blocks","created_at":"2025-12-21T16:42:10.719591+11:00","created_by":"gre538"}]}
{"id":"vedalang-byl","title":"P2-01: Implement PCG inference in compiler","description":"## Goal\nImplement automatic Primary Commodity Group (PCG) inference using xl2times rules, with optional explicit override.\n\n## Background\nPCG determines process activity definition in TIMES. The spec is already complete in docs/pcg_investigation.md.\n\n## Implementation\n\n### 1. Add `_infer_primary_commodity_group()` function\n```python\ndef _infer_primary_commodity_group(process: dict, commodities_by_name: dict) -\u003e str:\n    \"\"\"Infer PCG using xl2times rules: outputs before inputs, DEM\u003eMAT\u003eNRG\u003eENV\u003eFIN priority.\"\"\"\n    csets_order = ['DEM', 'MAT', 'NRG', 'ENV', 'FIN']\n    \n    # Try outputs first, then inputs\n    for io, flow_key in [('O', 'outputs'), ('I', 'inputs')]:\n        flows = process.get(flow_key, [])\n        for cset in csets_order:\n            for flow in flows:\n                comm = commodities_by_name.get(flow['commodity'], {})\n                comm_cset = _commodity_type_to_csets(comm.get('type', 'energy'))\n                if comm_cset == cset:\n                    return cset + io\n    \n    return 'NRGO'  # Fallback default\n```\n\n### 2. Update process emission\nAlways emit `primarycg` column in ~FI_PROCESS:\n- If explicit `primary_commodity_group` is set: use it\n- Otherwise: use inferred value\n\n### 3. Test cases\n- Simple thermal plant (NRG in/out) → NRGO\n- Demand device (NRG in, DEM out) → DEMO\n- Multi-output (NRG + ENV out) → NRGO (NRG wins over ENV)\n- Explicit override (CHP with forced NRGO)\n\n## Acceptance Criteria\n- [ ] `_infer_primary_commodity_group()` implemented\n- [ ] `primarycg` always emitted in ~FI_PROCESS rows\n- [ ] Regression tests for all 4 cases above\n- [ ] mini_plant.veda.yaml still compiles and validates\n\n## Dependencies\nNone (schema already has the field)\n\n## Parent\nvedalang-93s","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T16:35:38.83541+11:00","updated_at":"2025-12-22T17:04:11.485398+11:00","closed_at":"2025-12-22T17:04:11.485398+11:00","close_reason":"Superseded by vedalang-pcg-required - PCG should be required, not inferred"}
{"id":"vedalang-byn","title":"Define minimal vedalang.schema.json","description":"Define the JSON Schema for VedaLang - the typed DSL that compiles to VEDA tables.\n\n## Schema location:\n`vedalang/schema/vedalang.schema.json`\n\n## Design principles:\n- Start minimal - only enough to define one thermal plant with fuel/output\n- Schema-first: machine-readable definition enables tooling\n- Use YAML as source format (parsed to JSON for validation)\n\n## Proposed minimal structure:\n```yaml\nmodel:\n  name: MiniModel\n  description: A minimal test model\n  regions:\n    - REG1\n  \n  commodities:\n    - name: ELC\n      type: energy\n      unit: PJ\n    - name: NG  \n      type: energy\n      unit: PJ\n      \n  processes:\n    - name: PP_CCGT\n      description: Combined cycle gas turbine\n      sets: [ELE]\n      activity_unit: PJ\n      capacity_unit: GW\n      inputs:\n        - commodity: NG\n          share: 1.0\n      outputs:\n        - commodity: ELC\n          share: 1.0\n      efficiency: 0.55\n```\n\n## Schema features:\n- Required fields: model.name, regions, commodities, processes\n- Enums for commodity types, unit types\n- Cross-reference validation (process inputs reference defined commodities)\n\n## Deliverables:\n1. `vedalang/schema/vedalang.schema.json`\n2. `vedalang/examples/mini_plant.veda.yaml` - example source\n3. `tests/test_vedalang_schema.py` - validation tests\n\n## Acceptance:\n- Example validates against schema\n- Schema is documented with descriptions\n- Invalid examples are rejected with clear errors","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T16:43:17.763696+11:00","updated_at":"2025-12-21T17:03:35.958287+11:00","closed_at":"2025-12-21T17:03:35.958287+11:00","close_reason":"Closed","labels":["phase-3","schema","vedalang"],"dependencies":[{"issue_id":"vedalang-byn","depends_on_id":"vedalang-b4b","type":"blocks","created_at":"2025-12-21T16:43:17.764916+11:00","created_by":"gre538"}]}
{"id":"vedalang-c96","title":"Explore CHP (Combined Heat and Power)","description":"## Primitive: CHP\n**Parent:** vedalang-fq8\n\n## Intent\nProcess with multiple useful outputs (electricity + heat) from a single fuel.\n\n## Experiment Plan\n1. Create process with one fuel input (e.g., gas)\n2. Two outputs: ELC + HEAT with appropriate shares\n3. Test if multi-output with single efficiency works\n\n## Key Questions\n- How do output shares interact with efficiency?\n- Can we represent different heat-to-power ratios?\n\n## Success Criteria\n- veda_check SUCCESS or documented schema gap\n- Example: experiments/chp/model_chp_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:14:34.281911+11:00","updated_at":"2025-12-22T10:42:06.970293+11:00","closed_at":"2025-12-22T10:42:06.970293+11:00","close_reason":"CHP is fully expressible with current schema. Multi-output pattern works (ELC + HEAT). See experiments/chp/model_chp_v1.veda.yaml"}
{"id":"vedalang-cmt","title":"P2-01: Make primary_commodity_group required (no inference)","description":"## Goal\nMake Primary Commodity Group (PCG) **required and explicit** for all processes. No inference, no hidden defaults.\n\n## Rationale\nFollowing the VedaLang principle: **no hidden/hard-to-find defaults that cannot be checked at compile time.**\n\nPCG inference in xl2times uses complex priority rules (DEM\u003eMAT\u003eNRG\u003eENV\u003eFIN, outputs before inputs). If we silently infer, modelers may not realize their process activity is defined incorrectly until runtime. Making it explicit:\n- Forces modelers to understand what PCG means\n- Makes the model self-documenting\n- Enables compile-time validation\n- No surprises from inference rules\n\n## Schema Changes\nMake `primary_commodity_group` **required** in process definition:\n```json\n\"process\": {\n  \"required\": [\"name\", \"sets\", \"primary_commodity_group\"],\n  \"properties\": {\n    \"primary_commodity_group\": {\n      \"type\": \"string\",\n      \"enum\": [\"DEMI\", \"DEMO\", \"MATI\", \"MATO\", \"NRGI\", \"NRGO\", \"ENVI\", \"ENVO\", \"FINI\", \"FINO\"],\n      \"description\": \"Primary commodity group. Defines which commodity flows determine process activity. REQUIRED - no inference.\"\n    }\n  }\n}\n```\n\n## Compiler Changes\n1. **Do NOT implement** inference - schema validation rejects missing PCG\n2. Emit clear error message pointing to the issue\n3. Always emit `primarycg` column in ~FI_PROCESS (value from source)\n\n## Helper Documentation\nAdd to schema description or docs:\n| PCG | Meaning | Typical Use |\n|-----|---------|-------------|\n| NRGO | Energy outputs define activity | Power plants, refineries |\n| NRGI | Energy inputs define activity | Rare |\n| DEMO | Demand outputs define activity | Demand devices |\n| ENVO | Emission outputs define activity | Emission sources |\n| MATO | Material outputs define activity | Industrial processes |\n\n## Update Examples\nAll existing examples must be updated:\n- mini_plant.veda.yaml: add `primary_commodity_group: NRGO` to PP_CCGT\n- example_with_trade.veda.yaml: add PCG to all processes\n- example_with_constraints.veda.yaml: add PCG to all processes\n\n## Test Cases\n1. Process without PCG -\u003e schema validation error\n2. Process with valid PCG -\u003e compiles successfully\n3. Invalid PCG value -\u003e schema validation error\n4. All example files updated and pass validation\n\n## Acceptance Criteria\n- [ ] Schema updated: primary_commodity_group is required\n- [ ] No inference logic (explicit only)\n- [ ] All examples updated with explicit PCG\n- [ ] Tests for missing/invalid PCG\n- [ ] All tests pass\n\n## Dependencies\nNone\n\n## Parent\nvedalang-93s","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T17:04:39.673648+11:00","updated_at":"2025-12-22T17:43:02.733488+11:00","closed_at":"2025-12-22T17:43:02.733489+11:00"}
{"id":"vedalang-d16","title":"Wire pytest and add schema validation tests for xl2times outputs","description":"Set up pytest infrastructure and validate that existing JSON schemas match xl2times outputs.\n\n## Tasks:\n1. Ensure `pyproject.toml` has pytest configured correctly\n2. Create `tests/test_xl2times_schemas.py` with tests that:\n   - Load `output/diagnostics.json` and validate against `vedalang/schema/diagnostics.schema.json`\n   - Load `output/manifest.json` and validate against `vedalang/schema/manifest.schema.json`\n3. Use `jsonschema` library for validation\n\n## Commands:\n```bash\nuv run pytest tests/test_xl2times_schemas.py -v\n```\n\n## Acceptance:\n- `uv run pytest` runs successfully\n- Tests validate existing output JSONs against their schemas\n- Any schema/output mismatches are caught by tests","status":"closed","issue_type":"task","created_at":"2025-12-21T16:41:37.448204+11:00","updated_at":"2025-12-21T16:55:00.118542+11:00","closed_at":"2025-12-21T16:55:00.118542+11:00","close_reason":"Closed","labels":["phase-0","testing"],"dependencies":[{"issue_id":"vedalang-d16","depends_on_id":"vedalang-wrz","type":"blocks","created_at":"2025-12-21T16:41:37.449234+11:00","created_by":"gre538"}]}
{"id":"vedalang-d1u","title":"Add TableIR invariant assertions","description":"Add fast validation tests that check TableIR structure invariants before xl2times.","acceptance_criteria":"- [ ] Test: every `~FI_COMM` row has CommName, Csets, Unit\n- [ ] Test: every `~FI_PROCESS` row has TechName matching pattern\n- [ ] Test: every `~FI_T` row has TechName and (Comm-IN or Comm-OUT)\n- [ ] Invariants derived from `rules/constraints.yaml`\n- [ ] Runs as part of `veda_check` before xl2times call","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.721516+11:00","updated_at":"2025-12-21T20:49:53.435977+11:00","closed_at":"2025-12-21T20:49:53.435977+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-d1u","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:45.568615+11:00","created_by":"gre538"}]}
{"id":"vedalang-e0g","title":"Implement vedalang compiler skeleton (VedaLang → TableIR)","description":"Build the T3 tool: VedaLang compiler that transforms VedaLang source to TableIR.\n\n## Location:\n`vedalang/compiler/`\n\n## Components:\n\n1. **Library** (`vedalang/compiler/compiler.py`):\n   ```python\n   def compile_vedalang_to_tableir(source: dict) -\u003e dict:\n       '''Transform VedaLang AST to TableIR structure.'''\n   ```\n\n2. **CLI** (`vedalang/compiler/cli.py`):\n   ```bash\n   # Output TableIR only\n   vedalang compile src.veda.yaml --tableir out_tableir.yaml\n   \n   # Full pipeline to Excel (chains through veda_emit_excel)\n   vedalang compile src.veda.yaml --out model.xlsx\n   ```\n\n3. **Entry point** in `pyproject.toml`:\n   ```toml\n   [project.scripts]\n   vedalang = \"vedalang.compiler.cli:main\"\n   ```\n\n## Transformation logic (minimal):\n\n**Commodities** → `~FI_COMM` table:\n```\ncommodity.name → Csets\ncommodity.type → CTSLvl  \ncommodity.unit → Unit\n```\n\n**Processes** → `~FI_PROCESS` + `~FI_T` tables:\n```\nprocess.name → PRC\nprocess.sets → Sets\nprocess.activity_unit → TACT\nprocess.capacity_unit → TCAP\nprocess.inputs/outputs → COM_IN, COM_OUT\nprocess.efficiency → EFF\n```\n\n## File assignment heuristics:\n- Base commodities → `SysSettings/SysSettings.xlsx`\n- Processes → `SubRES_\u003ctype\u003e/SubRES_\u003ctype\u003e.xlsx`\n\n## Tests:\n`tests/test_vedalang_compiler.py`:\n- Compile `mini_plant.veda.yaml` to TableIR\n- Validate output against `tableir.schema.json`\n- Verify expected tags and row counts\n\n## Acceptance:\n- `uv run vedalang compile vedalang/examples/mini_plant.veda.yaml --tableir /tmp/out.yaml`\n- Output is valid TableIR\n- Full chain works: VedaLang → TableIR → Excel → xl2times (no errors)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T16:43:39.880755+11:00","updated_at":"2025-12-21T17:26:09.55551+11:00","closed_at":"2025-12-21T17:26:09.55551+11:00","close_reason":"Closed","labels":["compiler","phase-3","vedalang"],"dependencies":[{"issue_id":"vedalang-e0g","depends_on_id":"vedalang-byn","type":"blocks","created_at":"2025-12-21T16:43:39.881953+11:00","created_by":"gre538"},{"issue_id":"vedalang-e0g","depends_on_id":"vedalang-6ww","type":"blocks","created_at":"2025-12-21T16:43:39.882588+11:00","created_by":"gre538"}]}
{"id":"vedalang-fmq","title":"P0: Validate toolchain end-to-end with mini_plant","description":"Ensure the agent has a reliable playground before any schema evolution.","acceptance_criteria":"- [ ] `veda_check vedalang/examples/mini_plant.veda.yaml --from-vedalang` passes\n- [ ] Diagnostics JSON is parseable and has expected structure\n- [ ] Document any xl2times warnings/errors in a baseline file\n- [ ] Confirm manifest.json shows correct tables parsed","status":"closed","issue_type":"task","created_at":"2025-12-21T17:57:35.718598+11:00","updated_at":"2025-12-21T18:04:29.829369+11:00","closed_at":"2025-12-21T18:04:29.829369+11:00","close_reason":"Closed"}
{"id":"vedalang-fq8","title":"Epic: VedaLang Primitives Exploration","description":"Systematic exploration of 12 energy system primitives to extend VedaLang capabilities.\n\n## Goal\nHave an AI agent autonomously explore each primitive, validate with veda_check, and propose schema extensions where needed.\n\n## Primitives (in suggested order)\n1. CHP (Combined Heat and Power) - multi-output processes\n2. Storage - same-commodity input/output with efficiency\n3. Demand \u0026 demand trajectories - final energy demands\n4. Fuel supply \u0026 resource limits - upstream constraints\n5. Capacity bounds \u0026 build limits - NCAP_BND, CAP_BND\n6. Time-slicing / temporal structure - seasons, day/night\n7. Transmission within a region - HV/LV with losses\n8. Trade between regions - IRE-type processes\n9. User constraints / policy constraints - UC tables\n\n## Already Validated (DC1-DC5)\n- Thermal generation ✅\n- Renewable generation ✅\n- Emissions \u0026 emission pricing ✅\n\n## Protocol\nSee docs/exploration_prompt.md for full exploration protocol.\n\n## Success Criteria\n- Each primitive has at least one validated example or documented schema gap\n- Handoff records in experiments/handoff/\n- Schema extension proposals where needed","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:14:21.344314+11:00","updated_at":"2025-12-22T14:34:09.749479+11:00","closed_at":"2025-12-22T14:34:09.749479+11:00","close_reason":"Epic complete. All 10 primitives explored:\n- 3 patterns only (CHP, Storage, Transmission)\n- 5 implemented (Costs, Bounds, Timeslices, Trade, Demand)\n- 1 explored, impl pending (User Constraints → vedalang-vda)\n- 162 tests passing\n\nSchema extensions delivered:\n- Process costs (invcost, fixom, varom, life, cost)\n- Demand projection scenario type\n- Capacity/activity bounds (up/lo/fx)\n- Timeslices (season/daynite + fractions)\n- Trade links (bidirectional)\n\nSee experiments/handoff/ for all exploration records."}
{"id":"vedalang-hq1","title":"Investigate primary commodity group (PCG) explicit emission","description":"## Context\n\nDuring the xl2times auto-generation audit (thread T-019b443e-a940-723a-996f-79b5bd20a0f7), we identified that VedaLang does NOT currently emit explicit `primarycg` values for processes.\n\nxl2times has a `fill_in_missing_pcgs` function (transforms.py L1760-1806) that:\n1. Infers primary commodity groups from topology if not specified\n2. Uses `DefaultVedaPCG` flag based on commodity set ordering (DEM \u003e MAT \u003e NRG \u003e ENV \u003e FIN)\n3. Prefers OUT flows over IN flows when selecting default\n\n## Current VedaLang Behavior\n\n- We emit `sets` column (e.g., ELE, IMP, DMD) - this is explicit\n- We do NOT emit `primarycg` column - xl2times infers it\n\n## Risk Level\n\n**Medium** - The inference is deterministic and based on well-defined rules, but:\n- Users may not understand why a particular PCG was chosen\n- Edge cases with multiple output commodities could be surprising\n- Violates our 'explicit is better than implicit' principle\n\n## Investigation Tasks\n\n1. Understand when `primarycg` matters in TIMES modeling\n2. Determine if VedaLang should require explicit PCG or allow inference\n3. If explicit: add `primary_commodity_group` field to process schema\n4. If inference OK: document the rules in VedaLang spec\n\n## Related Code\n\n- xl2times: `fill_in_missing_pcgs` in transforms.py L1760-1806\n- xl2times: `_process_comm_groups_vectorised` in transforms.py L1535-1583\n- VedaLang: process schema in vedalang.schema.json","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T15:28:37.856779+11:00","updated_at":"2025-12-22T16:14:23.856667+11:00","closed_at":"2025-12-22T16:14:23.856667+11:00","close_reason":"Implemented PCG explicit emission with inference. Process schema has optional primary_commodity_group field, compiler always emits primarycg using xl2times rules. 6 new tests.","labels":["vedalang-schema"]}
{"id":"vedalang-ifa","title":"Add CHP and Storage patterns to patterns.yaml","description":"Document the validated CHP (multi-output) and Storage (same-commodity I/O) patterns in rules/patterns.yaml for future reference. See experiments/chp/ and experiments/storage/ for working examples.","notes":"Added add_chp_plant and add_storage patterns to rules/patterns.yaml","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-22T10:42:27.636337+11:00","updated_at":"2025-12-22T14:55:46.388394+11:00","closed_at":"2025-12-22T14:55:46.388396+11:00"}
{"id":"vedalang-ilt","title":"Implement trade_links in VedaLang schema and compiler","description":"Schema extension for inter-regional trade (IRE processes).\n\nBased on vedalang-87e exploration which validated the VEDA pattern with a working two-region model.\n\nChanges needed:\n1. Add to vedalang.schema.json:\n   ```yaml\n   model.trade_links:\n     - origin: REG1\n       destination: REG2\n       commodity: ELC\n       bidirectional: true  # Creates flows in both directions\n       efficiency: 0.98     # Optional: transport losses\n   ```\n\n2. Implement compiler lowering:\n   - Generate ~TRADELINKS_DINS table (normalized format)\n   - Place in SuppXLS/Trades/ScenTrade__Trade_Links.xlsx\n   - xl2times auto-generates IRE processes from this\n\n3. Trade processes are auto-named: TB_{COMM}_{REG1}_{REG2}_##\n\nKey VEDA patterns:\n- Bidirectional trade creates two TOP_IRE entries (one per direction)\n- Trade files follow SuppXLS/Trades/ convention\n- IRE_FLO parameter for efficiency, NCAP_BND for capacity\n\nSee:\n- experiments/trade/miniveda2_with_trade/ (working example)\n- experiments/handoff/session_2025-12-22_trade.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T12:23:08.528917+11:00","updated_at":"2025-12-22T14:03:26.572919+11:00","closed_at":"2025-12-22T14:03:26.572919+11:00","close_reason":"Implemented. Added trade_links array with origin/destination/commodity/bidirectional. Compiler emits ~TRADELINKS in matrix format to SuppXLS/Trades/. Efficiency deferred to vedalang-5zv. 7 tests added. See vedalang/examples/example_with_trade.veda.yaml","dependencies":[{"issue_id":"vedalang-ilt","depends_on_id":"vedalang-87e","type":"discovered-from","created_at":"2025-12-22T12:23:08.529986+11:00","created_by":"gre538"}]}
{"id":"vedalang-j9f","title":"DC1: Reproduce mini thermal plant via patterns","description":"First design challenge: Use patterns to generate a model semantically equivalent to `mini_plant.veda.yaml`.","acceptance_criteria":"- [ ] Generate VedaLang using `add_energy_commodity` (NG, ELC) + `add_power_plant` (PP_CCGT)\n- [ ] Compiled output matches structure of mini_plant's TableIR\n- [ ] Passes `veda_check --from-vedalang`\n- [ ] Create golden fixture `vedalang/examples/dc1_thermal_from_patterns.veda.yaml`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.719634+11:00","updated_at":"2025-12-21T20:11:07.506513+11:00","closed_at":"2025-12-21T20:11:07.506513+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-j9f","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:03.074181+11:00","created_by":"gre538"}]}
{"id":"vedalang-jis","title":"P2-Future: Storage and flexibility primitives","description":"## Goal\nAdd first-class storage process type with charge/discharge/round-trip efficiency semantics.\n\n## Use Case\nPractical energy models need:\n- Battery storage (short-duration)\n- Pumped hydro (daily/weekly)\n- Hydrogen storage (seasonal)\n\n## Possible Syntax\n```yaml\nprocesses:\n  - name: BATTERY\n    type: storage  # New process type\n    commodity: ELC\n    charge_efficiency: 0.95\n    discharge_efficiency: 0.95\n    storage_capacity: 4  # Hours at rated power\n    self_discharge: 0.001  # Per hour\n```\n\n## TIMES Mapping\nStorage requires:\n- STG process type\n- Separate charge/discharge flows\n- Storage capacity parameter (NCAP_STOR)\n- Inter-period storage (if seasonal)\n\n## Deferred because\n- Current exploration focused on generation/demand\n- Storage is complex (multiple TIMES constructs)\n- Should be informed by actual modeling need\n\n## References\n- Oracle recommendation: \"Advanced 3\"\n- Prior exploration: vedalang-1ak (Explore Storage)\n\n## Parent\nvedalang-93s","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-22T16:39:09.205248+11:00","updated_at":"2025-12-22T16:39:09.205248+11:00"}
{"id":"vedalang-jn9","title":"Add roundtrip tests: TableIR → Excel → xl2times","description":"Create integration tests that verify the full TableIR → Excel → xl2times pipeline works.\n\n## Test file:\n`tests/test_veda_emit_excel_roundtrip.py`\n\n## Test cases:\n\n1. **test_minimal_tableir_roundtrip**:\n   - Load `vedalang/examples/tableir_minimal.yaml`\n   - Run `veda_emit_excel` to emit Excel in temp directory\n   - Run `xl2times` on emitted Excel with `--manifest-json` and `--diagnostics-json`\n   - Assert:\n     - Exit code is 0\n     - Diagnostics has no errors (warnings OK)\n     - Manifest contains expected tags (~FI_PROCESS, ~FI_T)\n     - Row counts match TableIR input\n\n2. **test_invalid_tableir_rejected**:\n   - Try to emit from invalid TableIR\n   - Assert schema validation error is raised\n\n3. **test_emitted_excel_structure**:\n   - Emit Excel and inspect with openpyxl\n   - Verify sheet names, tag positions, column headers match TableIR\n\n## Acceptance:\n- All tests pass: `uv run pytest tests/test_veda_emit_excel_roundtrip.py -v`\n- Tests are deterministic and use temp directories\n- Tests clean up after themselves","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:42:59.653309+11:00","updated_at":"2025-12-21T17:27:47.353771+11:00","closed_at":"2025-12-21T17:27:47.353771+11:00","close_reason":"Closed","labels":["integration","phase-2","testing"],"dependencies":[{"issue_id":"vedalang-jn9","depends_on_id":"vedalang-6ww","type":"blocks","created_at":"2025-12-21T16:42:59.654406+11:00","created_by":"gre538"},{"issue_id":"vedalang-jn9","depends_on_id":"vedalang-rz8","type":"blocks","created_at":"2025-12-21T16:42:59.654953+11:00","created_by":"gre538"}]}
{"id":"vedalang-jno","title":"Implement timeslices in VedaLang schema and compiler","description":"Schema extension for timeslices - enables intra-annual temporal structure.\n\nBased on vedalang-6q7 exploration which validated the pattern with zero warnings/errors.\n\nChanges needed:\n1. Add to vedalang.schema.json:\n   ```yaml\n   model.timeslices:\n     season:\n       - {code: S, name: Summer, days: 175}\n       - {code: W, name: Winter, days: 190}\n     daynite:\n       - {code: D, name: Day}\n       - {code: N, name: Night}\n     fractions:\n       SD: 0.25\n       SN: 0.23\n       WD: 0.25\n       WN: 0.27\n   ```\n\n2. Add compile_timeslices() to compiler.py:\n   - Generate ~TIMESLICES table with season/daynite columns\n   - Generate ~TFM_INS rows with YRFR attribute (year fractions)\n   - Emit to VT_{region}_* file (required for xl2times region recognition)\n\n3. Update existing examples to include timeslices (eliminates MISSING_TIMESLICES warning)\n\nKey constraints:\n- Year fractions must sum to 1.0\n- VT_{BookName}_* file naming required for internal regions\n- Timeslice names auto-generated: SEASON+DAYNITE (e.g., SD, WN)\n\nSee:\n- experiments/timeslices/mini_plant_with_timeslices.tableir.yaml (validated example)\n- experiments/timeslices/schema_proposal.yaml\n- experiments/handoff/session_2025-12-22_timeslices.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T11:28:22.414792+11:00","updated_at":"2025-12-22T13:46:40.387404+11:00","closed_at":"2025-12-22T13:46:40.387404+11:00","close_reason":"Implemented. Added timeslices section with season/daynite arrays and fractions. Compiler emits ~TIMESLICES and ~TFM_INS (YRFR). VT_{region}_* file naming for region recognition. 10 tests added. 0 warnings with timeslices. See vedalang/examples/example_with_timeslices.veda.yaml","dependencies":[{"issue_id":"vedalang-jno","depends_on_id":"vedalang-6q7","type":"discovered-from","created_at":"2025-12-22T11:28:22.416146+11:00","created_by":"gre538"}]}
{"id":"vedalang-kpd","title":"Explore Demand \u0026 Demand Trajectories","description":"## Primitive: Demand\n**Parent:** vedalang-fq8\n\n## Intent\nRepresenting exogenous final demands and their evolution over time.\n\n## Experiment Plan\n1. **Approximate:** Use commodity type 'demand' with supply processes\n2. **Advanced:** Encode explicit demand trajectories over years\n\n## Key Questions\n- How does commodity type 'demand' behave in xl2times?\n- Can scenarios approximate demand growth?\n- What tables are needed for proper demand trajectories?\n\n## Potential Schema Extension\n- New scenario type: demand_trajectory\n\n## Success Criteria\n- Basic demand works OR proposal for demand trajectory support\n- Example: experiments/demand/model_demand_v1.veda.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T21:14:59.930344+11:00","updated_at":"2025-12-22T10:50:30.500907+11:00","closed_at":"2025-12-22T10:50:30.500907+11:00","close_reason":"Exploration complete. Demand commodities (type: demand) work. Demand LEVELS require schema extension - see vedalang-pdj for demand_projection implementation. See experiments/handoff/session_2025-12-22_demand.yaml"}
{"id":"vedalang-l5j","title":"Create example TableIR YAML with validation tests","description":"Create example TableIR files and tests to validate the schema works correctly.\n\n## Deliverables:\n\n1. `vedalang/examples/tableir_minimal.yaml`\n   - Minimal valid TableIR representing a simple power plant\n   - One process (e.g., PP_CCGT)\n   - Input commodity (natural gas)\n   - Output commodity (electricity)\n   - Efficiency parameter\n\n2. `vedalang/examples/tableir_invalid.yaml`\n   - Intentionally invalid for testing schema catches errors\n\n3. `tests/test_tableir_schema.py`\n   - Test that validates `tableir_minimal.yaml` passes schema\n   - Test that validates `tableir_invalid.yaml` fails schema\n   - Uses jsonschema library\n\n## Example content for tableir_minimal.yaml:\n```yaml\nfiles:\n  - path: SubRES_Thermal/SubRES_Thermal.xlsx\n    sheets:\n      - name: Thermal\n        tables:\n          - tag: \"~FI_PROCESS\"\n            rows:\n              - PRC: PP_CCGT\n                Sets: ELE\n                TACT: PJ\n                TCAP: GW\n          - tag: \"~FI_T\"\n            rows:\n              - PRC: PP_CCGT\n                COM_IN: NG\n                COM_OUT: ELC\n                EFF: 0.55\n```\n\n## Acceptance:\n- Example YAML exists and is valid\n- Tests pass: `uv run pytest tests/test_tableir_schema.py`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:42:25.858004+11:00","updated_at":"2025-12-21T17:03:37.49014+11:00","closed_at":"2025-12-21T17:03:37.49014+11:00","close_reason":"Closed","labels":["examples","phase-1","tableir"],"dependencies":[{"issue_id":"vedalang-l5j","depends_on_id":"vedalang-b4b","type":"blocks","created_at":"2025-12-21T16:42:25.859218+11:00","created_by":"gre538"}]}
{"id":"vedalang-m2k","title":"Add process cost attributes (invcost, fixom, varom, life)","description":"Schema extension P-costs-001: Add core cost parameters to process schema.\n\nChanges needed:\n1. Add to process schema in vedalang.schema.json:\n   - invcost (number) - investment cost per unit capacity\n   - fixom (number) - fixed O\u0026M per unit capacity per year  \n   - varom (number) - variable O\u0026M per unit activity\n   - life (number) - technical lifetime in years\n2. Extend compiler to emit these as columns in ~FI_T rows\n\nExample:\n```yaml\nprocesses:\n  - name: PP_CCGT\n    efficiency: 0.55\n    invcost: 800   # M€/GW\n    fixom: 20      # M€/GW/yr\n    varom: 2       # M€/PJ\n    life: 30       # years\n```\n\nSee: experiments/handoff/session_2025-12-22_fuel_supply.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T11:03:01.824307+11:00","updated_at":"2025-12-22T12:48:41.357752+11:00","closed_at":"2025-12-22T12:48:41.357752+11:00","close_reason":"Implemented. Added invcost, fixom, varom, life to process schema. Compiler emits to ~FI_T. Test added. See vedalang/examples/mini_plant_with_costs.veda.yaml","dependencies":[{"issue_id":"vedalang-m2k","depends_on_id":"vedalang-2cr","type":"discovered-from","created_at":"2025-12-22T11:03:01.825258+11:00","created_by":"gre538"}]}
{"id":"vedalang-n04","title":"Test improved xl2times diagnostic feedback loop with VedaLang","description":"Now that xl2times emits structured diagnostics instead of crashing, test the full feedback loop with VedaLang-generated output.\n\n**Goals**:\n1. Run veda_check on mini_plant.veda.yaml and verify we get actionable diagnostics\n2. Confirm diagnostics.json is produced with MISSING_REQUIRED_TABLE errors\n3. Document what tables are missing and what diagnostics are returned\n4. Update baseline_diagnostics.md with new results\n\n**Test scenarios**:\n- mini_plant.veda.yaml → should get diagnostics about missing system tables\n- Intentionally malformed input → should get INTERNAL_ERROR or specific diagnostics\n\n**Acceptance criteria**:\n- [ ] veda_check produces diagnostics.json (not crash)\n- [ ] Diagnostics list specific missing tables\n- [ ] Results documented in docs/baseline_diagnostics.md\n- [ ] Add integration test verifying diagnostic codes","status":"closed","issue_type":"task","created_at":"2025-12-21T18:25:41.925923+11:00","updated_at":"2025-12-21T18:35:12.999078+11:00","closed_at":"2025-12-21T18:35:12.999078+11:00","close_reason":"Closed","labels":["diagnostics","feedback-loop","testing"]}
{"id":"vedalang-pdj","title":"Implement demand_projection scenario type","description":"Schema extension P-demand-001: Add demand_projection scenario type to VedaLang.\n\nChanges needed:\n1. Add 'demand_projection' to scenario type enum in vedalang.schema.json\n2. Add conditional schema requiring commodity, values, interpolation\n3. Extend compiler._compile_scenario() to handle demand_projection\n4. Emit ~FI_T rows with attribute=DEMAND, commodity, year, value\n\nExample syntax:\n```yaml\nscenarios:\n  - name: BaseDemand\n    type: demand_projection\n    commodity: RSD\n    interpolation: interp_extrap\n    values:\n      2020: 100.0\n      2050: 160.0\n```\n\nSee: experiments/handoff/session_2025-12-22_demand.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T10:50:18.239538+11:00","updated_at":"2025-12-22T12:56:49.638047+11:00","closed_at":"2025-12-22T12:56:49.638047+11:00","close_reason":"Implemented. Added demand_projection scenario type that emits to ~FI_T with attribute=DEMAND. Uses same interpolation as commodity_price. 2 tests added. See vedalang/examples/example_with_demand.veda.yaml","dependencies":[{"issue_id":"vedalang-pdj","depends_on_id":"vedalang-kpd","type":"discovered-from","created_at":"2025-12-22T10:50:18.240682+11:00","created_by":"gre538"}]}
{"id":"vedalang-qye","title":"Create failure tracking infrastructure","description":"Set up infrastructure to capture and learn from failures during agent design exploration.","acceptance_criteria":"- [ ] `tests/failures/` directory structure created\n- [ ] Failure record schema defined (intent, input, tool, diagnostics, hypothesis)\n- [ ] Helper function to record failures as YAML/JSON\n- [ ] Process to convert failures to regression tests\n- [ ] Document failure classification (Type A/B/C) in AGENTS.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.72082+11:00","updated_at":"2025-12-21T20:53:27.258896+11:00","closed_at":"2025-12-21T20:53:27.258896+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-qye","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:29.629676+11:00","created_by":"gre538"}]}
{"id":"vedalang-rz8","title":"Commit MiniVEDA2 fixture with integration test","description":"Add a minimal VEDA fixture to enable reproducible testing of the full pipeline.\n\n## Background:\n- `xl2times.log` references `fixtures/MiniVEDA2/` but it's not committed\n- `output/manifest.json` shows successful runs against this fixture\n- We need reproducible test data\n\n## Tasks:\n1. Create or restore `fixtures/MiniVEDA2/` with minimal Excel files\n   - Should be small (1-3 Excel files)\n   - Must pass xl2times validation\n2. Add integration test `tests/test_xl2times_integration.py`:\n   - Runs `uv run xl2times fixtures/MiniVEDA2 --diagnostics-json ... --manifest-json ...`\n   - Validates output JSONs against schemas\n   - Asserts no hard errors in diagnostics\n\n## Acceptance:\n- `fixtures/MiniVEDA2/` exists and is committed\n- Integration test passes: `uv run pytest tests/test_xl2times_integration.py`\n- xl2times produces valid manifest and diagnostics","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:41:52.620716+11:00","updated_at":"2025-12-21T17:12:52.11848+11:00","closed_at":"2025-12-21T17:12:52.11848+11:00","close_reason":"Closed","labels":["fixtures","phase-0"],"dependencies":[{"issue_id":"vedalang-rz8","depends_on_id":"vedalang-d16","type":"blocks","created_at":"2025-12-21T16:41:52.622072+11:00","created_by":"gre538"}]}
{"id":"vedalang-s8u","title":"P1: TableIR experimentation - catalog valid VEDA patterns","description":"Learn valid VEDA structures by generating TableIR directly from patterns and validating with xl2times. Build a catalog of working patterns before touching VedaLang schema.","acceptance_criteria":"- [ ] Each pattern in `rules/patterns.yaml` has been tested via TableIR → Excel → xl2times\n- [ ] Document which patterns pass/fail and why in `docs/pattern_validation.md`\n- [ ] Create `vedalang/examples/tableir_*.yaml` golden files for each working pattern\n- [ ] Add tests asserting each golden TableIR passes veda_emit_excel","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.719212+11:00","updated_at":"2025-12-21T20:57:50.868868+11:00","closed_at":"2025-12-21T20:57:50.868868+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-s8u","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:58:57.746639+11:00","created_by":"gre538"}]}
{"id":"vedalang-sai","title":"DC5: Two-region model extension","description":"Design challenge 5: Same plant structure in two regions (REG1, REG2).","acceptance_criteria":"- [ ] Model has regions: [REG1, REG2]\n- [ ] Processes can be region-specific or shared\n- [ ] Correct Region fields in TableIR output\n- [ ] xl2times accepts multi-region layout\n- [ ] Create golden fixture `vedalang/examples/dc5_two_regions.veda.yaml`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:57:35.720584+11:00","updated_at":"2025-12-21T20:39:49.123955+11:00","closed_at":"2025-12-21T20:39:49.123955+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-sai","depends_on_id":"vedalang-19e","type":"blocks","created_at":"2025-12-21T17:59:24.359432+11:00","created_by":"gre538"}]}
{"id":"vedalang-sca","title":"xl2times: audit and harden all required-table access with diagnostics","description":"xl2times uses utils.single_table/single_column helpers that raise ValueError when tables are missing. These should emit structured diagnostics instead.\n\n**Task**:\n1. Search for single_table, single_column usages in xl2times\n2. Classify each as: (a) globally required, (b) feature-specific, (c) optional\n3. Refactor to:\n   - Check presence explicitly\n   - Emit MISSING_REQUIRED_TABLE or DUPLICATE_REQUIRED_TABLE diagnostics\n   - Provide fallback or graceful short-circuit\n4. Optional: add require_table() helper to encapsulate pattern\n\n**Acceptance criteria**:\n- [ ] All single_table/single_column call sites audited\n- [ ] At least 3 call sites converted to diagnostic-emitting pattern\n- [ ] Tests cover missing/duplicate cases\n- [ ] No more 'too few items in iterable' crashes on missing tables","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T18:11:37.397488+11:00","updated_at":"2025-12-21T18:21:39.721871+11:00","closed_at":"2025-12-21T18:21:39.721871+11:00","close_reason":"Closed","labels":["diagnostics","hardening","xl2times"],"dependencies":[{"issue_id":"vedalang-sca","depends_on_id":"vedalang-2bg","type":"blocks","created_at":"2025-12-21T18:11:48.009541+11:00","created_by":"gre538"},{"issue_id":"vedalang-sca","depends_on_id":"vedalang-73g","type":"blocks","created_at":"2025-12-21T18:11:53.334969+11:00","created_by":"gre538"}]}
{"id":"vedalang-scv","title":"P2-04: Implement MiniSystem model in VedaLang","description":"## Goal\nImplement the MiniSystem model as specified in P2-03, in a single VedaLang YAML file.\n\n## Deliverable\n`vedalang/examples/minisystem.veda.yaml`\n\n## Implementation Notes\n\n### Structure\nSingle file with all model elements:\n```yaml\nmodel:\n  name: MiniSystem\n  description: Two-region energy system for VedaLang validation\n  \n  regions: [NORTH, SOUTH]\n  start_year: 2020\n  time_periods: [10, 10, 10, 10]\n  \n  timeslices:\n    season: [{code: SU}, {code: WI}]\n    daynite: [{code: D}, {code: N}]\n    fractions:\n      SUD: 0.25\n      SUN: 0.25\n      WID: 0.25\n      WIN: 0.25\n  \n  commodities: [...]\n  processes: [...]\n  trade_links: [...]\n  scenarios: [...]\n  constraints: [...]\n```\n\n### Process examples to include\n1. **PP_CCGT** - Gas plant with efficiency, invcost, life, CO2 output\n2. **PP_WIND** - No fuel input, just ELC output (tests PCG inference)\n3. **DEM_RSD** - Demand device (tests DEMO PCG inference)\n4. **IMP_NG** - Supply with cost (tests cost attribute)\n\n### Validation\nAfter implementation:\n```bash\n# Compile and validate\nuv run veda_check vedalang/examples/minisystem.veda.yaml --from-vedalang\n\n# Check for warnings\nuv run veda_check vedalang/examples/minisystem.veda.yaml --from-vedalang --json | jq '.diagnostics[] | select(.severity == \"warning\")'\n```\n\n### Document friction points\nWhile implementing, document any:\n- Awkward syntax patterns\n- Missing conveniences\n- Confusing error messages\n- Places where you had to \"think in VEDA tables\"\n\nSave notes in `docs/minisystem_friction.md` for P2-06.\n\n## Acceptance Criteria\n- [ ] minisystem.veda.yaml created\n- [ ] Compiles without errors via `vedalang compile`\n- [ ] Passes `veda_check --from-vedalang` validation\n- [ ] All specified features are exercised\n- [ ] Friction points documented\n\n## Dependencies\n- P2-01: PCG inference (for correct process behavior)\n- P2-02: Semantic validation (for early error detection)\n- P2-03: Model specification (defines what to implement)\n\n## Parent\nvedalang-93s","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T16:37:05.776055+11:00","updated_at":"2025-12-23T10:14:20.149673+11:00","closed_at":"2025-12-23T10:14:20.149673+11:00","close_reason":"Model implemented at vedalang/examples/minisystem.veda.yaml"}
{"id":"vedalang-vda","title":"Implement user constraints (emission_cap, activity_share types)","description":"Schema extension P-uc-001: Add pre-built constraint types for common UC patterns.\n\nBased on vedalang-9df exploration. User constraints are complex - start with common patterns:\n\n**Phase 1 (this issue):**\n```yaml\nmodel:\n  constraints:\n    - name: CO2_CAP\n      type: emission_cap\n      commodity: CO2\n      limit: 100\n      limtype: up\n    \n    - name: REN_TARGET\n      type: activity_share\n      commodity: ELC\n      processes: [PP_WIND, PP_SOLAR]\n      minimum_share: 0.30\n```\n\n**Compiler generates:**\n- ~UC_T tables with appropriate attributes\n- UC_COMPRD/UC_COMNET for emission caps\n- UC_ACT for activity shares\n\n**Blockers:**\n- xl2times hit 'description' KeyError on UC table processing\n- Need to investigate xl2times UC handling first\n\n**Deferred to future:**\n- General-purpose UC syntax\n- Timeslice-specific constraints\n- Growth rate constraints\n\nSee: experiments/handoff/session_2025-12-22_user_constraints.yaml","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T14:33:27.902584+11:00","updated_at":"2025-12-22T15:47:26.800481+11:00","closed_at":"2025-12-22T15:47:26.800481+11:00","close_reason":"Implemented emission_cap and activity_share constraint types. Schema extended with constraints array, compiler emits ~UC_T tables. 8 new tests passing. Blocker: xl2times needs uc_sets metadata from Excel.","dependencies":[{"issue_id":"vedalang-vda","depends_on_id":"vedalang-9df","type":"discovered-from","created_at":"2025-12-22T14:33:27.903775+11:00","created_by":"gre538"}]}
{"id":"vedalang-w1m","title":"Add schema evolution policy and checks","description":"Implement policy and automated checks for safe schema evolution.","acceptance_criteria":"- [ ] Document schema evolution policy in `docs/schema_evolution.md`\n- [ ] Add test that detects breaking schema changes\n- [ ] List allowed vs disallowed changes\n- [ ] Add pre-commit hook or CI check (optional)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.72127+11:00","updated_at":"2025-12-21T20:37:30.444982+11:00","closed_at":"2025-12-21T20:37:30.444982+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-w1m","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:40.25778+11:00","created_by":"gre538"}]}
{"id":"vedalang-wrz","title":"Scaffold repo directory structure per AGENTS.md","description":"Create the directory structure defined in AGENTS.md that doesn't exist yet:\n\n## Directories to create:\n- `vedalang/compiler/` - with `__init__.py` placeholder\n- `vedalang/examples/` - with README explaining purpose\n- `tools/veda_emit_excel/` - with `__init__.py` placeholder\n- `tools/veda_check/` - with `__init__.py` placeholder  \n- `rules/` - with stub YAML files (patterns.yaml, constraints.yaml, decision_tree.yaml)\n- `tests/` - top-level test directory\n\n## Acceptance:\n- All directories exist with placeholder files\n- Running `uv run pytest tests/` works (even if no tests yet)\n- Structure matches AGENTS.md repo layout section","status":"closed","issue_type":"task","created_at":"2025-12-21T16:41:23.92226+11:00","updated_at":"2025-12-21T16:53:11.938681+11:00","closed_at":"2025-12-21T16:53:11.938681+11:00","close_reason":"Closed","labels":["phase-0","scaffolding"]}
{"id":"vedalang-xru","title":"Implement veda_check orchestration CLI","description":"Build the T4 tool: unified orchestration wrapper that provides the agent feedback loop.\n\n## Location:\n`tools/veda_check/`\n\n## Purpose:\nSingle command that runs compile → emit → validate with unified diagnostics output.\nThis is the primary interface for AI agents iterating on VedaLang models.\n\n## CLI:\n```bash\n# From VedaLang source\nveda_check src/ --from-vedalang --case base\n\n# From TableIR (skip compiler)\nveda_check tables.yaml --from-tableir --case base\n\n# Output options\nveda_check src/ --from-vedalang --json  # JSON output for parsing\nveda_check src/ --from-vedalang --verbose  # Detailed output\n```\n\n## Pipeline:\n1. If `--from-vedalang`: run vedalang compiler → TableIR\n2. Run veda_emit_excel → Excel files in temp dir\n3. Run xl2times with `--diagnostics-json` and `--manifest-json`\n4. Parse and validate JSON outputs against schemas\n5. Print unified summary:\n   - Tables parsed (from manifest)\n   - Warnings/errors (from diagnostics)\n   - Exit code: 0=success, 1=warnings, 2=errors\n\n## Entry point in `pyproject.toml`:\n```toml\n[project.scripts]\nveda_check = \"tools.veda_check.cli:main\"\n```\n\n## Output format (table):\n```\n┌─────────────────────────────────────────────────┐\n│ veda_check results                              │\n├─────────────────────────────────────────────────┤\n│ Source: src/mini_plant.veda.yaml                │\n│ Tables: 3 (~FI_COMM, ~FI_PROCESS, ~FI_T)        │\n│ Rows: 5 total                                   │\n│ Warnings: 0                                     │\n│ Errors: 0                                       │\n│ Status: ✓ PASS                                  │\n└─────────────────────────────────────────────────┘\n```\n\n## Tests:\n`tests/test_veda_check.py`:\n- Run on valid VedaLang source → exit 0\n- Run on source with warnings → exit 1\n- Run on invalid source → appropriate error\n\n## Acceptance:\n- `uv run veda_check vedalang/examples/mini_plant.veda.yaml --from-vedalang`\n- Clear, actionable output\n- JSON mode works for programmatic use","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T16:44:01.207807+11:00","updated_at":"2025-12-21T17:37:13.83391+11:00","closed_at":"2025-12-21T17:37:13.83391+11:00","close_reason":"Closed","labels":["orchestration","phase-4","tooling"],"dependencies":[{"issue_id":"vedalang-xru","depends_on_id":"vedalang-e0g","type":"blocks","created_at":"2025-12-21T16:44:01.209104+11:00","created_by":"gre538"},{"issue_id":"vedalang-xru","depends_on_id":"vedalang-jn9","type":"blocks","created_at":"2025-12-21T16:44:01.20974+11:00","created_by":"gre538"}]}

{"id":"vedalang-02l","title":"Seed rules/ with initial pattern library","description":"Create the initial pattern library for mapping modeling concepts to VedaLang/TableIR.\n\n## Location:\n`rules/`\n\n## Files to create:\n\n### 1. `rules/patterns.yaml`\nDefine reusable patterns for common modeling constructs:\n```yaml\npatterns:\n  add_power_plant:\n    description: Define a thermal generation process\n    parameters:\n      - name: plant_name\n      - name: fuel_commodity\n      - name: output_commodity\n      - name: efficiency\n        default: 0.40\n      - name: capacity_unit\n        default: GW\n    vedalang_template: |\n      processes:\n        - name: {{ plant_name }}\n          sets: [ELE]\n          inputs:\n            - commodity: {{ fuel_commodity }}\n          outputs:\n            - commodity: {{ output_commodity }}\n          efficiency: {{ efficiency }}\n          capacity_unit: {{ capacity_unit }}\n  \n  co2_price_trajectory:\n    description: Define a CO2 price scenario\n    parameters:\n      - name: prices  # dict of year -\u003e price\n    tableir_template: |\n      tag: ~TFM_INS-TS\n      rows:\n        {% for year, price in prices.items() %}\n        - YEAR: {{ year }}\n          COM: CO2\n          VALUE: {{ price }}\n        {% endfor %}\n```\n\n### 2. `rules/constraints.yaml`\nDefine valid combinations of tags/files:\n```yaml\nconstraints:\n  tag_file_mapping:\n    ~FI_COMM: [SysSettings/*.xlsx, BY_Trans/*.xlsx]\n    ~FI_PROCESS: [SubRES_*/*.xlsx, BY_Trans/*.xlsx]\n    ~FI_T: [SubRES_*/*.xlsx, BY_Trans/*.xlsx]\n  \n  required_fields:\n    ~FI_PROCESS: [PRC, Sets]\n    ~FI_T: [PRC, COM_IN | COM_OUT]\n```\n\n### 3. `rules/decision_tree.yaml`\nRoute modeling intent to appropriate patterns:\n```yaml\nintents:\n  add_generation:\n    keywords: [power plant, generator, thermal]\n    pattern: add_power_plant\n  \n  add_emissions_price:\n    keywords: [CO2 price, carbon tax, emissions]\n    pattern: co2_price_trajectory\n```\n\n## Acceptance:\n- All three YAML files exist with initial content\n- Structure is documented (comments or README)\n- At least one pattern (add_power_plant) is fully defined","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-21T16:44:22.743074+11:00","updated_at":"2025-12-21T17:35:22.890536+11:00","closed_at":"2025-12-21T17:35:22.890536+11:00","close_reason":"Closed","labels":["patterns","phase-5","rules"],"dependencies":[{"issue_id":"vedalang-02l","depends_on_id":"vedalang-e0g","type":"blocks","created_at":"2025-12-21T16:44:22.744336+11:00","created_by":"gre538"}]}
{"id":"vedalang-0rg","title":"Add golden fixture regression tests","description":"Create regression test suite that validates all golden fixtures pass through the full pipeline.","acceptance_criteria":"- [ ] `tests/test_golden_fixtures.py` runs veda_check on all examples\n- [ ] Test fails if any fixture breaks\n- [ ] Test captures TableIR snapshots for comparison\n- [ ] CI runs this on every change","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.721053+11:00","updated_at":"2025-12-21T20:08:38.430318+11:00","closed_at":"2025-12-21T20:08:38.430318+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-0rg","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:34.954422+11:00","created_by":"gre538"}]}
{"id":"vedalang-19e","title":"DC4: Add CO2 price trajectory scenario","description":"Design challenge 4: Apply CO2 price over 2025-2030. First scenario/TFM construct.","acceptance_criteria":"- [ ] `co2_price_trajectory` pattern produces valid `~TFM_INS-TS` TableIR\n- [ ] VedaLang schema extended to support scenarios (minimal structure)\n- [ ] Compiler maps scenario → TableIR correctly\n- [ ] xl2times accepts the scenario tables\n- [ ] Create golden fixture `vedalang/examples/dc4_co2_price_scenario.veda.yaml`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:57:35.720366+11:00","updated_at":"2025-12-21T20:31:52.233649+11:00","closed_at":"2025-12-21T20:31:52.233649+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-19e","depends_on_id":"vedalang-a9w","type":"blocks","created_at":"2025-12-21T17:59:18.988213+11:00","created_by":"gre538"}]}
{"id":"vedalang-1ex","title":"DC2: Add renewable plant sharing output commodity","description":"Design challenge 2: Thermal + renewable plant both producing ELC. Tests multiple processes sharing a commodity.","acceptance_criteria":"- [ ] Model has PP_CCGT (gas) + PP_WIND (wind) both outputting ELC\n- [ ] Both processes appear in `~FI_PROCESS` with correct Sets\n- [ ] Both have correct `~FI_T` entries (thermal has efficiency, renewable does not)\n- [ ] Passes xl2times validation\n- [ ] Create golden fixture `vedalang/examples/dc2_thermal_renewable.veda.yaml`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.719917+11:00","updated_at":"2025-12-21T20:16:28.901359+11:00","closed_at":"2025-12-21T20:16:28.901359+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-1ex","depends_on_id":"vedalang-j9f","type":"blocks","created_at":"2025-12-21T17:59:08.366363+11:00","created_by":"gre538"}]}
{"id":"vedalang-2bg","title":"xl2times: graceful handling and diagnostics for missing ~BOOKREGIONS_MAP","description":"xl2times crashes with 'ValueError: too few items in iterable' when ~BOOKREGIONS_MAP is missing. The crash is in transforms.fill_in_column_defaults calling utils.single_table(), which uses more_itertools.one.\n\n**Root cause**: transforms.py line ~150 assumes ~BOOKREGIONS_MAP exists.\n\n**Fix**:\n- Replace utils.single_table() with safe lookup (next(..., None))\n- When missing: emit MISSING_REQUIRED_TABLE diagnostic with severity=error\n- Fall back to model.internal_regions so pipeline continues\n- Ensure diagnostics.json is produced\n\n**Acceptance criteria**:\n- [ ] Missing ~BOOKREGIONS_MAP emits structured diagnostic, not crash\n- [ ] Diagnostic has code=MISSING_REQUIRED_TABLE, context={table_tag, table_kind}\n- [ ] Pipeline continues and produces diagnostics.json\n- [ ] xl2times exits non-zero when errors present\n- [ ] Test covers missing table case","status":"closed","issue_type":"task","created_at":"2025-12-21T18:11:09.616693+11:00","updated_at":"2025-12-21T18:15:42.674738+11:00","closed_at":"2025-12-21T18:15:42.674738+11:00","close_reason":"Closed","labels":["crash-fix","diagnostics","xl2times"]}
{"id":"vedalang-5rj","title":"Document agent design workflow in AGENTS.md","description":"Update AGENTS.md with the agent design workflow, phases, and guardrails.","acceptance_criteria":"- [ ] Document the 5 phases (P0-P4)\n- [ ] Document design challenges (DC1-DC5)\n- [ ] Document failure handling process\n- [ ] Document guardrails (golden fixtures, schema policy)\n- [ ] Document the design loop: prototype at TableIR → validate → lift to VedaLang","status":"closed","issue_type":"task","created_at":"2025-12-21T17:57:35.722151+11:00","updated_at":"2025-12-21T20:02:45.817687+11:00","closed_at":"2025-12-21T20:02:45.817687+11:00","close_reason":"Closed"}
{"id":"vedalang-6ww","title":"Implement veda_emit_excel (TableIR to Excel emitter)","description":"Build the T2 tool: TableIR → Excel emitter. This is the experimentation layer for VEDA patterns.\n\n## Location:\n`tools/veda_emit_excel/`\n\n## Components:\n\n1. **Library** (`tools/veda_emit_excel/__init__.py`):\n   ```python\n   def emit_excel(tableir: dict, out_dir: Path) -\u003e list[Path]:\n       '''Convert TableIR dict to Excel files, return paths created.'''\n   ```\n\n2. **CLI** (`tools/veda_emit_excel/cli.py`):\n   ```bash\n   veda_emit_excel tables.yaml --out output_dir/\n   veda_emit_excel tables.yaml --out model.xlsx  # single file mode\n   ```\n\n3. **Entry point** in `pyproject.toml`:\n   ```toml\n   [project.scripts]\n   veda_emit_excel = \"tools.veda_emit_excel.cli:main\"\n   ```\n\n## Functionality:\n- Load TableIR from YAML or JSON\n- Validate against `tableir.schema.json` (fail fast on invalid input)\n- Use `openpyxl` to create workbooks\n- For each file in TableIR:\n  - Create workbook at specified path\n  - For each sheet, create worksheet\n  - For each table, write tag row then header row then data rows\n- Handle VEDA table format quirks (tag in first cell, etc.)\n\n## Acceptance:\n- `uv run veda_emit_excel vedalang/examples/tableir_minimal.yaml --out /tmp/test/`\n- Creates valid Excel file(s) that xl2times can read\n- Schema validation errors produce clear messages","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-21T16:42:44.080281+11:00","updated_at":"2025-12-21T17:19:13.716944+11:00","closed_at":"2025-12-21T17:19:13.716944+11:00","close_reason":"Closed","labels":["emitter","phase-2","tooling"],"dependencies":[{"issue_id":"vedalang-6ww","depends_on_id":"vedalang-l5j","type":"blocks","created_at":"2025-12-21T16:42:44.081432+11:00","created_by":"gre538"}]}
{"id":"vedalang-73g","title":"xl2times: always produce diagnostics.json on unexpected errors","description":"When xl2times encounters an uncaught exception, it terminates without writing diagnostics.json even if --diagnostics-json was requested. This breaks the feedback loop for VedaLang.\n\n**Fix**:\n- Wrap main pipeline in try/except in run()\n- On Exception: emit INTERNAL_ERROR diagnostic via get_collector().error()\n- Always write diagnostics.json if flag was provided\n- Include exception type/message in diagnostic context\n- Exit non-zero\n\n**Acceptance criteria**:\n- [ ] Uncaught exceptions produce diagnostics.json with INTERNAL_ERROR\n- [ ] Diagnostic includes exception_type and message in context\n- [ ] Process exits non-zero\n- [ ] Test simulates exception and verifies diagnostics.json created","status":"closed","issue_type":"task","created_at":"2025-12-21T18:11:23.177764+11:00","updated_at":"2025-12-21T18:17:48.844423+11:00","closed_at":"2025-12-21T18:17:48.844423+11:00","close_reason":"Closed","labels":["diagnostics","error-handling","xl2times"]}
{"id":"vedalang-79r","title":"xl2times: Make all input validation errors fail gracefully with diagnostics","description":"When running xl2times on VedaLang-emitted input decks, we still get hard failures (KeyError, AttributeError, etc.) for missing/malformed input data. These should all emit structured diagnostics instead.\n\n**Current state**: After our recent fixes, xl2times emits diagnostics for missing tables. But we still get:\n- KeyError: 'tact' (column name case mismatch)\n- Other crashes from missing columns or malformed data\n\n**Goal**: Every input validation failure should:\n1. Emit a structured diagnostic with specific code (MISSING_COLUMN, INVALID_VALUE, etc.)\n2. Continue processing where possible to collect more diagnostics\n3. Exit non-zero with complete diagnostics.json\n\n**Hard failures should ONLY indicate xl2times bugs, not input problems.**\n\n**Approach**:\n1. Run veda_check on mini_plant.veda.yaml, capture the INTERNAL_ERROR\n2. Trace the KeyError to its source in xl2times\n3. Add defensive handling + diagnostic emission\n4. Repeat until no more INTERNAL_ERRORs from input validation\n5. Add tests for each case fixed\n\n**Acceptance criteria**:\n- [ ] mini_plant.veda.yaml produces only MISSING_* diagnostics, no INTERNAL_ERROR\n- [ ] Each missing column/table has specific diagnostic code\n- [ ] All diagnostics have actionable messages\n- [ ] Tests cover each fixed case","status":"closed","issue_type":"task","created_at":"2025-12-21T18:37:59.42649+11:00","updated_at":"2025-12-21T19:06:34.611795+11:00","closed_at":"2025-12-21T19:06:34.611795+11:00","close_reason":"Closed","labels":["diagnostics","hardening","input-validation","xl2times"]}
{"id":"vedalang-a65","title":"Build pattern expansion tool","description":"Implement tooling to expand patterns from the pattern library into VedaLang or TableIR.\n\n## Location:\n`tools/veda_patterns/`\n\n## Purpose:\nAllow agents to invoke patterns by name with parameters, getting valid VedaLang/TableIR output.\n\n## API:\n```python\nfrom tools.veda_patterns import expand_pattern\n\nresult = expand_pattern(\n    pattern_name='add_power_plant',\n    parameters={\n        'plant_name': 'PP_CCGT',\n        'fuel_commodity': 'NG',\n        'output_commodity': 'ELC',\n        'efficiency': 0.55\n    },\n    output_format='vedalang'  # or 'tableir'\n)\n```\n\n## CLI:\n```bash\nveda_pattern expand add_power_plant \\\n  --param plant_name=PP_CCGT \\\n  --param fuel_commodity=NG \\\n  --param output_commodity=ELC \\\n  --format vedalang\n```\n\n## Implementation:\n- Load patterns from `rules/patterns.yaml`\n- Use Jinja2 for template expansion\n- Validate expanded output against appropriate schema\n- Support both VedaLang and TableIR output formats\n\n## Tests:\n`tests/test_patterns_expand.py`:\n- Expand add_power_plant pattern\n- Validate output against schema\n- Full pipeline: expand → compile → emit → xl2times validate\n\n## Acceptance:\n- Pattern expansion produces valid VedaLang/TableIR\n- Missing required parameters raise clear errors\n- Default parameter values work correctly","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-21T16:44:38.96754+11:00","updated_at":"2025-12-21T17:43:02.561383+11:00","closed_at":"2025-12-21T17:43:02.561383+11:00","close_reason":"Closed","labels":["patterns","phase-5","tooling"],"dependencies":[{"issue_id":"vedalang-a65","depends_on_id":"vedalang-02l","type":"blocks","created_at":"2025-12-21T16:44:38.968957+11:00","created_by":"gre538"},{"issue_id":"vedalang-a65","depends_on_id":"vedalang-e0g","type":"blocks","created_at":"2025-12-21T16:44:38.969657+11:00","created_by":"gre538"}]}
{"id":"vedalang-a9w","title":"DC3: Introduce emission commodity and emission factor","description":"Design challenge 3: Gas plant emits CO2 per unit fuel burned. Forces schema extension for emissions.","acceptance_criteria":"- [ ] CO2 commodity defined with type: emission\n- [ ] PP_CCGT has associated CO2 output with emission factor\n- [ ] Valid `~FI_COMM` entry for CO2 (Csets: ENV)\n- [ ] Valid `~FI_T` entry linking process to CO2 emission\n- [ ] xl2times accepts the emission structure\n- [ ] Create golden fixture `vedalang/examples/dc3_with_emissions.veda.yaml`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:57:35.720146+11:00","updated_at":"2025-12-21T20:24:16.156813+11:00","closed_at":"2025-12-21T20:24:16.156813+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-a9w","depends_on_id":"vedalang-1ex","type":"blocks","created_at":"2025-12-21T17:59:13.698656+11:00","created_by":"gre538"}]}
{"id":"vedalang-b4b","title":"Design and implement tableir.schema.json","description":"Define the JSON Schema for TableIR - the intermediate representation between VedaLang and Excel.\n\n## Schema location:\n`vedalang/schema/tableir.schema.json`\n\n## Required structure (per AGENTS.md):\n```yaml\nfiles:\n  - path: base/base.xlsx\n    sheets:\n      - name: \"Base\"\n        tables:\n          - tag: \"~FI_PROCESS\"\n            rows:\n              - { PRC: \"PP_CCGT\", Sets: \"ELE\", TACT: \"PJ\", TCAP: \"GW\" }\n          - tag: \"~FI_T\"\n            rows:\n              - { PRC: \"PP_CCGT\", COM_IN: \"NG\", COM_OUT: \"ELC\", EFF: 0.55 }\n```\n\n## Schema design:\n- Top-level: `files[]` array\n- Each file: `path` (string), `sheets[]` array\n- Each sheet: `name` (string), `tables[]` array\n- Each table: `tag` (string starting with ~), `rows[]` array\n- Rows: objects with string keys (VEDA column names), values can be string/number\n\n## Minimal tags to support initially:\n- `~FI_PROCESS` - process definitions\n- `~FI_T` - process topology (inputs/outputs/efficiency)\n- `~FI_COMM` - commodity definitions\n\n## Acceptance:\n- Schema validates the example TableIR from AGENTS.md\n- Schema is well-documented with descriptions\n- Test validates example against schema","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:42:10.718395+11:00","updated_at":"2025-12-21T16:55:29.769981+11:00","closed_at":"2025-12-21T16:55:29.769981+11:00","close_reason":"Closed","labels":["phase-1","schema","tableir"],"dependencies":[{"issue_id":"vedalang-b4b","depends_on_id":"vedalang-wrz","type":"blocks","created_at":"2025-12-21T16:42:10.719591+11:00","created_by":"gre538"}]}
{"id":"vedalang-byn","title":"Define minimal vedalang.schema.json","description":"Define the JSON Schema for VedaLang - the typed DSL that compiles to VEDA tables.\n\n## Schema location:\n`vedalang/schema/vedalang.schema.json`\n\n## Design principles:\n- Start minimal - only enough to define one thermal plant with fuel/output\n- Schema-first: machine-readable definition enables tooling\n- Use YAML as source format (parsed to JSON for validation)\n\n## Proposed minimal structure:\n```yaml\nmodel:\n  name: MiniModel\n  description: A minimal test model\n  regions:\n    - REG1\n  \n  commodities:\n    - name: ELC\n      type: energy\n      unit: PJ\n    - name: NG  \n      type: energy\n      unit: PJ\n      \n  processes:\n    - name: PP_CCGT\n      description: Combined cycle gas turbine\n      sets: [ELE]\n      activity_unit: PJ\n      capacity_unit: GW\n      inputs:\n        - commodity: NG\n          share: 1.0\n      outputs:\n        - commodity: ELC\n          share: 1.0\n      efficiency: 0.55\n```\n\n## Schema features:\n- Required fields: model.name, regions, commodities, processes\n- Enums for commodity types, unit types\n- Cross-reference validation (process inputs reference defined commodities)\n\n## Deliverables:\n1. `vedalang/schema/vedalang.schema.json`\n2. `vedalang/examples/mini_plant.veda.yaml` - example source\n3. `tests/test_vedalang_schema.py` - validation tests\n\n## Acceptance:\n- Example validates against schema\n- Schema is documented with descriptions\n- Invalid examples are rejected with clear errors","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T16:43:17.763696+11:00","updated_at":"2025-12-21T17:03:35.958287+11:00","closed_at":"2025-12-21T17:03:35.958287+11:00","close_reason":"Closed","labels":["phase-3","schema","vedalang"],"dependencies":[{"issue_id":"vedalang-byn","depends_on_id":"vedalang-b4b","type":"blocks","created_at":"2025-12-21T16:43:17.764916+11:00","created_by":"gre538"}]}
{"id":"vedalang-d16","title":"Wire pytest and add schema validation tests for xl2times outputs","description":"Set up pytest infrastructure and validate that existing JSON schemas match xl2times outputs.\n\n## Tasks:\n1. Ensure `pyproject.toml` has pytest configured correctly\n2. Create `tests/test_xl2times_schemas.py` with tests that:\n   - Load `output/diagnostics.json` and validate against `vedalang/schema/diagnostics.schema.json`\n   - Load `output/manifest.json` and validate against `vedalang/schema/manifest.schema.json`\n3. Use `jsonschema` library for validation\n\n## Commands:\n```bash\nuv run pytest tests/test_xl2times_schemas.py -v\n```\n\n## Acceptance:\n- `uv run pytest` runs successfully\n- Tests validate existing output JSONs against their schemas\n- Any schema/output mismatches are caught by tests","status":"closed","issue_type":"task","created_at":"2025-12-21T16:41:37.448204+11:00","updated_at":"2025-12-21T16:55:00.118542+11:00","closed_at":"2025-12-21T16:55:00.118542+11:00","close_reason":"Closed","labels":["phase-0","testing"],"dependencies":[{"issue_id":"vedalang-d16","depends_on_id":"vedalang-wrz","type":"blocks","created_at":"2025-12-21T16:41:37.449234+11:00","created_by":"gre538"}]}
{"id":"vedalang-d1u","title":"Add TableIR invariant assertions","description":"Add fast validation tests that check TableIR structure invariants before xl2times.","acceptance_criteria":"- [ ] Test: every `~FI_COMM` row has CommName, Csets, Unit\n- [ ] Test: every `~FI_PROCESS` row has TechName matching pattern\n- [ ] Test: every `~FI_T` row has TechName and (Comm-IN or Comm-OUT)\n- [ ] Invariants derived from `rules/constraints.yaml`\n- [ ] Runs as part of `veda_check` before xl2times call","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.721516+11:00","updated_at":"2025-12-21T20:49:53.435977+11:00","closed_at":"2025-12-21T20:49:53.435977+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-d1u","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:45.568615+11:00","created_by":"gre538"}]}
{"id":"vedalang-e0g","title":"Implement vedalang compiler skeleton (VedaLang → TableIR)","description":"Build the T3 tool: VedaLang compiler that transforms VedaLang source to TableIR.\n\n## Location:\n`vedalang/compiler/`\n\n## Components:\n\n1. **Library** (`vedalang/compiler/compiler.py`):\n   ```python\n   def compile_vedalang_to_tableir(source: dict) -\u003e dict:\n       '''Transform VedaLang AST to TableIR structure.'''\n   ```\n\n2. **CLI** (`vedalang/compiler/cli.py`):\n   ```bash\n   # Output TableIR only\n   vedalang compile src.veda.yaml --tableir out_tableir.yaml\n   \n   # Full pipeline to Excel (chains through veda_emit_excel)\n   vedalang compile src.veda.yaml --out model.xlsx\n   ```\n\n3. **Entry point** in `pyproject.toml`:\n   ```toml\n   [project.scripts]\n   vedalang = \"vedalang.compiler.cli:main\"\n   ```\n\n## Transformation logic (minimal):\n\n**Commodities** → `~FI_COMM` table:\n```\ncommodity.name → Csets\ncommodity.type → CTSLvl  \ncommodity.unit → Unit\n```\n\n**Processes** → `~FI_PROCESS` + `~FI_T` tables:\n```\nprocess.name → PRC\nprocess.sets → Sets\nprocess.activity_unit → TACT\nprocess.capacity_unit → TCAP\nprocess.inputs/outputs → COM_IN, COM_OUT\nprocess.efficiency → EFF\n```\n\n## File assignment heuristics:\n- Base commodities → `SysSettings/SysSettings.xlsx`\n- Processes → `SubRES_\u003ctype\u003e/SubRES_\u003ctype\u003e.xlsx`\n\n## Tests:\n`tests/test_vedalang_compiler.py`:\n- Compile `mini_plant.veda.yaml` to TableIR\n- Validate output against `tableir.schema.json`\n- Verify expected tags and row counts\n\n## Acceptance:\n- `uv run vedalang compile vedalang/examples/mini_plant.veda.yaml --tableir /tmp/out.yaml`\n- Output is valid TableIR\n- Full chain works: VedaLang → TableIR → Excel → xl2times (no errors)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T16:43:39.880755+11:00","updated_at":"2025-12-21T17:26:09.55551+11:00","closed_at":"2025-12-21T17:26:09.55551+11:00","close_reason":"Closed","labels":["compiler","phase-3","vedalang"],"dependencies":[{"issue_id":"vedalang-e0g","depends_on_id":"vedalang-byn","type":"blocks","created_at":"2025-12-21T16:43:39.881953+11:00","created_by":"gre538"},{"issue_id":"vedalang-e0g","depends_on_id":"vedalang-6ww","type":"blocks","created_at":"2025-12-21T16:43:39.882588+11:00","created_by":"gre538"}]}
{"id":"vedalang-fmq","title":"P0: Validate toolchain end-to-end with mini_plant","description":"Ensure the agent has a reliable playground before any schema evolution.","acceptance_criteria":"- [ ] `veda_check vedalang/examples/mini_plant.veda.yaml --from-vedalang` passes\n- [ ] Diagnostics JSON is parseable and has expected structure\n- [ ] Document any xl2times warnings/errors in a baseline file\n- [ ] Confirm manifest.json shows correct tables parsed","status":"closed","issue_type":"task","created_at":"2025-12-21T17:57:35.718598+11:00","updated_at":"2025-12-21T18:04:29.829369+11:00","closed_at":"2025-12-21T18:04:29.829369+11:00","close_reason":"Closed"}
{"id":"vedalang-j9f","title":"DC1: Reproduce mini thermal plant via patterns","description":"First design challenge: Use patterns to generate a model semantically equivalent to `mini_plant.veda.yaml`.","acceptance_criteria":"- [ ] Generate VedaLang using `add_energy_commodity` (NG, ELC) + `add_power_plant` (PP_CCGT)\n- [ ] Compiled output matches structure of mini_plant's TableIR\n- [ ] Passes `veda_check --from-vedalang`\n- [ ] Create golden fixture `vedalang/examples/dc1_thermal_from_patterns.veda.yaml`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.719634+11:00","updated_at":"2025-12-21T20:11:07.506513+11:00","closed_at":"2025-12-21T20:11:07.506513+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-j9f","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:03.074181+11:00","created_by":"gre538"}]}
{"id":"vedalang-jn9","title":"Add roundtrip tests: TableIR → Excel → xl2times","description":"Create integration tests that verify the full TableIR → Excel → xl2times pipeline works.\n\n## Test file:\n`tests/test_veda_emit_excel_roundtrip.py`\n\n## Test cases:\n\n1. **test_minimal_tableir_roundtrip**:\n   - Load `vedalang/examples/tableir_minimal.yaml`\n   - Run `veda_emit_excel` to emit Excel in temp directory\n   - Run `xl2times` on emitted Excel with `--manifest-json` and `--diagnostics-json`\n   - Assert:\n     - Exit code is 0\n     - Diagnostics has no errors (warnings OK)\n     - Manifest contains expected tags (~FI_PROCESS, ~FI_T)\n     - Row counts match TableIR input\n\n2. **test_invalid_tableir_rejected**:\n   - Try to emit from invalid TableIR\n   - Assert schema validation error is raised\n\n3. **test_emitted_excel_structure**:\n   - Emit Excel and inspect with openpyxl\n   - Verify sheet names, tag positions, column headers match TableIR\n\n## Acceptance:\n- All tests pass: `uv run pytest tests/test_veda_emit_excel_roundtrip.py -v`\n- Tests are deterministic and use temp directories\n- Tests clean up after themselves","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:42:59.653309+11:00","updated_at":"2025-12-21T17:27:47.353771+11:00","closed_at":"2025-12-21T17:27:47.353771+11:00","close_reason":"Closed","labels":["integration","phase-2","testing"],"dependencies":[{"issue_id":"vedalang-jn9","depends_on_id":"vedalang-6ww","type":"blocks","created_at":"2025-12-21T16:42:59.654406+11:00","created_by":"gre538"},{"issue_id":"vedalang-jn9","depends_on_id":"vedalang-rz8","type":"blocks","created_at":"2025-12-21T16:42:59.654953+11:00","created_by":"gre538"}]}
{"id":"vedalang-l5j","title":"Create example TableIR YAML with validation tests","description":"Create example TableIR files and tests to validate the schema works correctly.\n\n## Deliverables:\n\n1. `vedalang/examples/tableir_minimal.yaml`\n   - Minimal valid TableIR representing a simple power plant\n   - One process (e.g., PP_CCGT)\n   - Input commodity (natural gas)\n   - Output commodity (electricity)\n   - Efficiency parameter\n\n2. `vedalang/examples/tableir_invalid.yaml`\n   - Intentionally invalid for testing schema catches errors\n\n3. `tests/test_tableir_schema.py`\n   - Test that validates `tableir_minimal.yaml` passes schema\n   - Test that validates `tableir_invalid.yaml` fails schema\n   - Uses jsonschema library\n\n## Example content for tableir_minimal.yaml:\n```yaml\nfiles:\n  - path: SubRES_Thermal/SubRES_Thermal.xlsx\n    sheets:\n      - name: Thermal\n        tables:\n          - tag: \"~FI_PROCESS\"\n            rows:\n              - PRC: PP_CCGT\n                Sets: ELE\n                TACT: PJ\n                TCAP: GW\n          - tag: \"~FI_T\"\n            rows:\n              - PRC: PP_CCGT\n                COM_IN: NG\n                COM_OUT: ELC\n                EFF: 0.55\n```\n\n## Acceptance:\n- Example YAML exists and is valid\n- Tests pass: `uv run pytest tests/test_tableir_schema.py`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:42:25.858004+11:00","updated_at":"2025-12-21T17:03:37.49014+11:00","closed_at":"2025-12-21T17:03:37.49014+11:00","close_reason":"Closed","labels":["examples","phase-1","tableir"],"dependencies":[{"issue_id":"vedalang-l5j","depends_on_id":"vedalang-b4b","type":"blocks","created_at":"2025-12-21T16:42:25.859218+11:00","created_by":"gre538"}]}
{"id":"vedalang-n04","title":"Test improved xl2times diagnostic feedback loop with VedaLang","description":"Now that xl2times emits structured diagnostics instead of crashing, test the full feedback loop with VedaLang-generated output.\n\n**Goals**:\n1. Run veda_check on mini_plant.veda.yaml and verify we get actionable diagnostics\n2. Confirm diagnostics.json is produced with MISSING_REQUIRED_TABLE errors\n3. Document what tables are missing and what diagnostics are returned\n4. Update baseline_diagnostics.md with new results\n\n**Test scenarios**:\n- mini_plant.veda.yaml → should get diagnostics about missing system tables\n- Intentionally malformed input → should get INTERNAL_ERROR or specific diagnostics\n\n**Acceptance criteria**:\n- [ ] veda_check produces diagnostics.json (not crash)\n- [ ] Diagnostics list specific missing tables\n- [ ] Results documented in docs/baseline_diagnostics.md\n- [ ] Add integration test verifying diagnostic codes","status":"closed","issue_type":"task","created_at":"2025-12-21T18:25:41.925923+11:00","updated_at":"2025-12-21T18:35:12.999078+11:00","closed_at":"2025-12-21T18:35:12.999078+11:00","close_reason":"Closed","labels":["diagnostics","feedback-loop","testing"]}
{"id":"vedalang-qye","title":"Create failure tracking infrastructure","description":"Set up infrastructure to capture and learn from failures during agent design exploration.","acceptance_criteria":"- [ ] `tests/failures/` directory structure created\n- [ ] Failure record schema defined (intent, input, tool, diagnostics, hypothesis)\n- [ ] Helper function to record failures as YAML/JSON\n- [ ] Process to convert failures to regression tests\n- [ ] Document failure classification (Type A/B/C) in AGENTS.md","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.72082+11:00","updated_at":"2025-12-21T20:53:27.258896+11:00","closed_at":"2025-12-21T20:53:27.258896+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-qye","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:29.629676+11:00","created_by":"gre538"}]}
{"id":"vedalang-rz8","title":"Commit MiniVEDA2 fixture with integration test","description":"Add a minimal VEDA fixture to enable reproducible testing of the full pipeline.\n\n## Background:\n- `xl2times.log` references `fixtures/MiniVEDA2/` but it's not committed\n- `output/manifest.json` shows successful runs against this fixture\n- We need reproducible test data\n\n## Tasks:\n1. Create or restore `fixtures/MiniVEDA2/` with minimal Excel files\n   - Should be small (1-3 Excel files)\n   - Must pass xl2times validation\n2. Add integration test `tests/test_xl2times_integration.py`:\n   - Runs `uv run xl2times fixtures/MiniVEDA2 --diagnostics-json ... --manifest-json ...`\n   - Validates output JSONs against schemas\n   - Asserts no hard errors in diagnostics\n\n## Acceptance:\n- `fixtures/MiniVEDA2/` exists and is committed\n- Integration test passes: `uv run pytest tests/test_xl2times_integration.py`\n- xl2times produces valid manifest and diagnostics","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T16:41:52.620716+11:00","updated_at":"2025-12-21T17:12:52.11848+11:00","closed_at":"2025-12-21T17:12:52.11848+11:00","close_reason":"Closed","labels":["fixtures","phase-0"],"dependencies":[{"issue_id":"vedalang-rz8","depends_on_id":"vedalang-d16","type":"blocks","created_at":"2025-12-21T16:41:52.622072+11:00","created_by":"gre538"}]}
{"id":"vedalang-s8u","title":"P1: TableIR experimentation - catalog valid VEDA patterns","description":"Learn valid VEDA structures by generating TableIR directly from patterns and validating with xl2times. Build a catalog of working patterns before touching VedaLang schema.","acceptance_criteria":"- [ ] Each pattern in `rules/patterns.yaml` has been tested via TableIR → Excel → xl2times\n- [ ] Document which patterns pass/fail and why in `docs/pattern_validation.md`\n- [ ] Create `vedalang/examples/tableir_*.yaml` golden files for each working pattern\n- [ ] Add tests asserting each golden TableIR passes veda_emit_excel","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.719212+11:00","updated_at":"2025-12-21T20:57:10.996588+11:00","closed_at":"2025-12-21T20:57:10.996588+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-s8u","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:58:57.746639+11:00","created_by":"gre538"}]}
{"id":"vedalang-sai","title":"DC5: Two-region model extension","description":"Design challenge 5: Same plant structure in two regions (REG1, REG2).","acceptance_criteria":"- [ ] Model has regions: [REG1, REG2]\n- [ ] Processes can be region-specific or shared\n- [ ] Correct Region fields in TableIR output\n- [ ] xl2times accepts multi-region layout\n- [ ] Create golden fixture `vedalang/examples/dc5_two_regions.veda.yaml`","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-21T17:57:35.720584+11:00","updated_at":"2025-12-21T20:39:49.123955+11:00","closed_at":"2025-12-21T20:39:49.123955+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-sai","depends_on_id":"vedalang-19e","type":"blocks","created_at":"2025-12-21T17:59:24.359432+11:00","created_by":"gre538"}]}
{"id":"vedalang-sca","title":"xl2times: audit and harden all required-table access with diagnostics","description":"xl2times uses utils.single_table/single_column helpers that raise ValueError when tables are missing. These should emit structured diagnostics instead.\n\n**Task**:\n1. Search for single_table, single_column usages in xl2times\n2. Classify each as: (a) globally required, (b) feature-specific, (c) optional\n3. Refactor to:\n   - Check presence explicitly\n   - Emit MISSING_REQUIRED_TABLE or DUPLICATE_REQUIRED_TABLE diagnostics\n   - Provide fallback or graceful short-circuit\n4. Optional: add require_table() helper to encapsulate pattern\n\n**Acceptance criteria**:\n- [ ] All single_table/single_column call sites audited\n- [ ] At least 3 call sites converted to diagnostic-emitting pattern\n- [ ] Tests cover missing/duplicate cases\n- [ ] No more 'too few items in iterable' crashes on missing tables","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T18:11:37.397488+11:00","updated_at":"2025-12-21T18:21:39.721871+11:00","closed_at":"2025-12-21T18:21:39.721871+11:00","close_reason":"Closed","labels":["diagnostics","hardening","xl2times"],"dependencies":[{"issue_id":"vedalang-sca","depends_on_id":"vedalang-2bg","type":"blocks","created_at":"2025-12-21T18:11:48.009541+11:00","created_by":"gre538"},{"issue_id":"vedalang-sca","depends_on_id":"vedalang-73g","type":"blocks","created_at":"2025-12-21T18:11:53.334969+11:00","created_by":"gre538"}]}
{"id":"vedalang-w1m","title":"Add schema evolution policy and checks","description":"Implement policy and automated checks for safe schema evolution.","acceptance_criteria":"- [ ] Document schema evolution policy in `docs/schema_evolution.md`\n- [ ] Add test that detects breaking schema changes\n- [ ] List allowed vs disallowed changes\n- [ ] Add pre-commit hook or CI check (optional)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-21T17:57:35.72127+11:00","updated_at":"2025-12-21T20:37:30.444982+11:00","closed_at":"2025-12-21T20:37:30.444982+11:00","close_reason":"Closed","dependencies":[{"issue_id":"vedalang-w1m","depends_on_id":"vedalang-fmq","type":"blocks","created_at":"2025-12-21T17:59:40.25778+11:00","created_by":"gre538"}]}
{"id":"vedalang-wrz","title":"Scaffold repo directory structure per AGENTS.md","description":"Create the directory structure defined in AGENTS.md that doesn't exist yet:\n\n## Directories to create:\n- `vedalang/compiler/` - with `__init__.py` placeholder\n- `vedalang/examples/` - with README explaining purpose\n- `tools/veda_emit_excel/` - with `__init__.py` placeholder\n- `tools/veda_check/` - with `__init__.py` placeholder  \n- `rules/` - with stub YAML files (patterns.yaml, constraints.yaml, decision_tree.yaml)\n- `tests/` - top-level test directory\n\n## Acceptance:\n- All directories exist with placeholder files\n- Running `uv run pytest tests/` works (even if no tests yet)\n- Structure matches AGENTS.md repo layout section","status":"closed","issue_type":"task","created_at":"2025-12-21T16:41:23.92226+11:00","updated_at":"2025-12-21T16:53:11.938681+11:00","closed_at":"2025-12-21T16:53:11.938681+11:00","close_reason":"Closed","labels":["phase-0","scaffolding"]}
{"id":"vedalang-xru","title":"Implement veda_check orchestration CLI","description":"Build the T4 tool: unified orchestration wrapper that provides the agent feedback loop.\n\n## Location:\n`tools/veda_check/`\n\n## Purpose:\nSingle command that runs compile → emit → validate with unified diagnostics output.\nThis is the primary interface for AI agents iterating on VedaLang models.\n\n## CLI:\n```bash\n# From VedaLang source\nveda_check src/ --from-vedalang --case base\n\n# From TableIR (skip compiler)\nveda_check tables.yaml --from-tableir --case base\n\n# Output options\nveda_check src/ --from-vedalang --json  # JSON output for parsing\nveda_check src/ --from-vedalang --verbose  # Detailed output\n```\n\n## Pipeline:\n1. If `--from-vedalang`: run vedalang compiler → TableIR\n2. Run veda_emit_excel → Excel files in temp dir\n3. Run xl2times with `--diagnostics-json` and `--manifest-json`\n4. Parse and validate JSON outputs against schemas\n5. Print unified summary:\n   - Tables parsed (from manifest)\n   - Warnings/errors (from diagnostics)\n   - Exit code: 0=success, 1=warnings, 2=errors\n\n## Entry point in `pyproject.toml`:\n```toml\n[project.scripts]\nveda_check = \"tools.veda_check.cli:main\"\n```\n\n## Output format (table):\n```\n┌─────────────────────────────────────────────────┐\n│ veda_check results                              │\n├─────────────────────────────────────────────────┤\n│ Source: src/mini_plant.veda.yaml                │\n│ Tables: 3 (~FI_COMM, ~FI_PROCESS, ~FI_T)        │\n│ Rows: 5 total                                   │\n│ Warnings: 0                                     │\n│ Errors: 0                                       │\n│ Status: ✓ PASS                                  │\n└─────────────────────────────────────────────────┘\n```\n\n## Tests:\n`tests/test_veda_check.py`:\n- Run on valid VedaLang source → exit 0\n- Run on source with warnings → exit 1\n- Run on invalid source → appropriate error\n\n## Acceptance:\n- `uv run veda_check vedalang/examples/mini_plant.veda.yaml --from-vedalang`\n- Clear, actionable output\n- JSON mode works for programmatic use","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-21T16:44:01.207807+11:00","updated_at":"2025-12-21T17:37:13.83391+11:00","closed_at":"2025-12-21T17:37:13.83391+11:00","close_reason":"Closed","labels":["orchestration","phase-4","tooling"],"dependencies":[{"issue_id":"vedalang-xru","depends_on_id":"vedalang-e0g","type":"blocks","created_at":"2025-12-21T16:44:01.209104+11:00","created_by":"gre538"},{"issue_id":"vedalang-xru","depends_on_id":"vedalang-jn9","type":"blocks","created_at":"2025-12-21T16:44:01.20974+11:00","created_by":"gre538"}]}
